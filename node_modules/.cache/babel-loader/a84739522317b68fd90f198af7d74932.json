{"ast":null,"code":"Object.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.getDependentQueries = exports.extractPropsFromState = exports.getValidInterval = exports.getRSQuery = exports.hasPaginationSupport = exports.isComponentUsesLabelAsValue = exports.isSearchComponent = exports.isDRSRangeComponent = exports.getHistogramComponentID = exports.getInternalComponentID = exports.isInternalComponent = exports.getNormalizedField = exports.componentToTypeMap = undefined;\n\nvar _extends = Object.assign || function (target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i];\n\n    for (var key in source) {\n      if (Object.prototype.hasOwnProperty.call(source, key)) {\n        target[key] = source[key];\n      }\n    }\n  }\n\n  return target;\n};\n\nvar _componentToTypeMap;\n\nexports.flatReactProp = flatReactProp;\n\nvar _xdate = require('xdate');\n\nvar _xdate2 = _interopRequireDefault(_xdate);\n\nvar _constants = require('./constants');\n\nvar _dateFormats = require('./dateFormats');\n\nvar _dateFormats2 = _interopRequireDefault(_dateFormats);\n\nvar _helper = require('./helper');\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction _toConsumableArray(arr) {\n  if (Array.isArray(arr)) {\n    for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) {\n      arr2[i] = arr[i];\n    }\n\n    return arr2;\n  } else {\n    return Array.from(arr);\n  }\n}\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nvar componentToTypeMap = exports.componentToTypeMap = (_componentToTypeMap = {}, _defineProperty(_componentToTypeMap, _constants.componentTypes.reactiveList, _constants.queryTypes.search), _defineProperty(_componentToTypeMap, _constants.componentTypes.dataSearch, _constants.queryTypes.search), _defineProperty(_componentToTypeMap, _constants.componentTypes.categorySearch, _constants.queryTypes.search), _defineProperty(_componentToTypeMap, _constants.componentTypes.searchBox, _constants.queryTypes.suggestion), _defineProperty(_componentToTypeMap, _constants.componentTypes.singleList, _constants.queryTypes.term), _defineProperty(_componentToTypeMap, _constants.componentTypes.multiList, _constants.queryTypes.term), _defineProperty(_componentToTypeMap, _constants.componentTypes.singleDataList, _constants.queryTypes.term), _defineProperty(_componentToTypeMap, _constants.componentTypes.singleDropdownList, _constants.queryTypes.term), _defineProperty(_componentToTypeMap, _constants.componentTypes.multiDataList, _constants.queryTypes.term), _defineProperty(_componentToTypeMap, _constants.componentTypes.multiDropdownList, _constants.queryTypes.term), _defineProperty(_componentToTypeMap, _constants.componentTypes.tagCloud, _constants.queryTypes.term), _defineProperty(_componentToTypeMap, _constants.componentTypes.toggleButton, _constants.queryTypes.term), _defineProperty(_componentToTypeMap, _constants.componentTypes.numberBox, _constants.queryTypes.term), _defineProperty(_componentToTypeMap, _constants.componentTypes.datePicker, _constants.queryTypes.range), _defineProperty(_componentToTypeMap, _constants.componentTypes.dateRange, _constants.queryTypes.range), _defineProperty(_componentToTypeMap, _constants.componentTypes.dynamicRangeSlider, _constants.queryTypes.range), _defineProperty(_componentToTypeMap, _constants.componentTypes.singleDropdownRange, _constants.queryTypes.range), _defineProperty(_componentToTypeMap, _constants.componentTypes.multiDropdownRange, _constants.queryTypes.range), _defineProperty(_componentToTypeMap, _constants.componentTypes.singleRange, _constants.queryTypes.range), _defineProperty(_componentToTypeMap, _constants.componentTypes.multiRange, _constants.queryTypes.range), _defineProperty(_componentToTypeMap, _constants.componentTypes.rangeSlider, _constants.queryTypes.range), _defineProperty(_componentToTypeMap, _constants.componentTypes.ratingsFilter, _constants.queryTypes.range), _defineProperty(_componentToTypeMap, _constants.componentTypes.rangeInput, _constants.queryTypes.range), _defineProperty(_componentToTypeMap, _constants.componentTypes.geoDistanceDropdown, _constants.queryTypes.geo), _defineProperty(_componentToTypeMap, _constants.componentTypes.geoDistanceSlider, _constants.queryTypes.geo), _defineProperty(_componentToTypeMap, _constants.componentTypes.reactiveMap, _constants.queryTypes.geo), _componentToTypeMap);\nvar multiRangeComponents = [_constants.componentTypes.multiRange, _constants.componentTypes.multiDropdownRange];\nvar dateRangeComponents = [_constants.componentTypes.dateRange, _constants.componentTypes.datePicker];\nvar searchComponents = [_constants.componentTypes.categorySearch, _constants.componentTypes.dataSearch, _constants.componentTypes.searchBox];\nvar listComponentsWithPagination = [_constants.componentTypes.singleList, _constants.componentTypes.multiList, _constants.componentTypes.singleDropdownList, _constants.componentTypes.multiDropdownList];\n\nvar getNormalizedField = exports.getNormalizedField = function getNormalizedField(field) {\n  if (field && !Array.isArray(field)) {\n    return [field];\n  }\n\n  return field;\n};\n\nvar isInternalComponent = exports.isInternalComponent = function isInternalComponent() {\n  var componentID = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';\n  return componentID.endsWith('__internal');\n};\n\nvar getInternalComponentID = exports.getInternalComponentID = function getInternalComponentID() {\n  var componentID = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';\n  return componentID + '__internal';\n};\n\nvar getHistogramComponentID = exports.getHistogramComponentID = function getHistogramComponentID() {\n  var componentID = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';\n  return componentID + '__histogram__internal';\n};\n\nvar isDRSRangeComponent = exports.isDRSRangeComponent = function isDRSRangeComponent() {\n  var componentID = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';\n  return componentID.endsWith('__range__internal');\n};\n\nvar isSearchComponent = exports.isSearchComponent = function isSearchComponent() {\n  var componentType = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';\n  return searchComponents.includes(componentType);\n};\n\nvar isComponentUsesLabelAsValue = exports.isComponentUsesLabelAsValue = function isComponentUsesLabelAsValue() {\n  var componentType = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';\n  return componentType === _constants.componentTypes.multiDataList || componentType === _constants.componentTypes.singleDataList;\n};\n\nvar hasPaginationSupport = exports.hasPaginationSupport = function hasPaginationSupport() {\n  var componentType = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';\n  return listComponentsWithPagination.includes(componentType);\n};\n\nvar getRSQuery = exports.getRSQuery = function getRSQuery(componentId, props) {\n  var execute = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;\n\n  if (props && componentId) {\n    var queryType = props.type ? props.type : componentToTypeMap[props.componentType];\n\n    if (!isSearchComponent(props.componentType) && !props.dataField) {\n      return null;\n    }\n\n    return _extends({\n      id: componentId,\n      type: queryType,\n      dataField: getNormalizedField(props.dataField),\n      execute: execute,\n      react: props.react,\n      highlight: props.highlight,\n      highlightField: getNormalizedField(props.highlightField),\n      fuzziness: props.fuzziness,\n      searchOperators: props.searchOperators,\n      includeFields: props.includeFields,\n      excludeFields: props.excludeFields,\n      size: props.size,\n      aggregationSize: props.aggregationSize,\n      from: props.from,\n      queryFormat: props.queryFormat,\n      sortBy: props.sortBy,\n      fieldWeights: getNormalizedField(props.fieldWeights),\n      includeNullValues: props.includeNullValues,\n      aggregationField: props.aggregationField || undefined,\n      categoryField: props.categoryField || undefined,\n      missingLabel: props.missingLabel || undefined,\n      showMissing: props.showMissing,\n      nestedField: props.nestedField || undefined,\n      interval: props.interval,\n      customHighlight: props.customHighlight,\n      customQuery: props.customQuery,\n      defaultQuery: props.defaultQuery,\n      value: props.value,\n      categoryValue: props.categoryValue || undefined,\n      after: props.after || undefined,\n      aggregations: props.aggregations || undefined,\n      enableSynonyms: props.enableSynonyms,\n      selectAllLabel: props.selectAllLabel,\n      pagination: props.pagination,\n      queryString: props.queryString,\n      distinctField: props.distinctField,\n      distinctFieldConfig: props.distinctFieldConfig,\n      index: props.index\n    }, queryType === _constants.queryTypes.suggestion ? {\n      enablePopularSuggestions: props.enablePopularSuggestions,\n      enableRecentSuggestions: props.enableRecentSuggestions,\n      popularSuggestionsConfig: props.popularSuggestionsConfig,\n      recentSuggestionsConfig: props.recentSuggestionsConfig,\n      applyStopwords: props.applyStopwords,\n      customStopwords: props.customStopwords,\n      enablePredictiveSuggestions: props.enablePredictiveSuggestions\n    } : {}, {\n      calendarInterval: props.calendarInterval\n    });\n  }\n\n  return null;\n};\n\nvar getValidInterval = exports.getValidInterval = function getValidInterval(interval) {\n  var range = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  var min = Math.ceil((range.end - range.start) / 100) || 1;\n\n  if (!interval) {\n    return min;\n  } else if (interval < min) {\n    return min;\n  }\n\n  return interval;\n};\n\nvar extractPropsFromState = exports.extractPropsFromState = function extractPropsFromState(store, component, customOptions) {\n  var componentProps = store.props[component];\n\n  if (!componentProps) {\n    return null;\n  }\n\n  var queryType = componentToTypeMap[componentProps.componentType];\n  var calcValues = store.selectedValues[component] || store.internalValues[component];\n  var value = calcValues !== undefined && calcValues !== null ? calcValues.value : undefined;\n  var queryFormat = componentProps.queryFormat;\n  var calendarInterval = void 0;\n  var interval = componentProps.interval;\n  var type = componentToTypeMap[componentProps.componentType];\n  var dataField = componentProps.dataField;\n  var aggregations = void 0;\n  var pagination = void 0;\n  var from = componentProps.from;\n\n  if (queryType === _constants.queryTypes.term) {\n    if (componentProps.showLoadMore && hasPaginationSupport(componentProps.componentType)) {\n      pagination = true;\n    }\n\n    if (value != null && typeof value === 'object' && value.value) {\n      value = value.value;\n    } else if (Array.isArray(value)) {\n      var parsedValue = [];\n      value.forEach(function (val) {\n        if (val != null && typeof val === 'object' && val.value) {\n          parsedValue.push(val.value);\n        } else {\n          parsedValue.push(val);\n        }\n      });\n      value = parsedValue;\n    }\n  }\n\n  if (queryType === _constants.queryTypes.range) {\n    if (Array.isArray(value)) {\n      if (multiRangeComponents.includes(componentProps.componentType)) {\n        value = value.map(function (_ref) {\n          var start = _ref.start,\n              end = _ref.end;\n          return {\n            start: start,\n            end: end\n          };\n        });\n      } else {\n        value = {\n          start: value[0],\n          end: value[1]\n        };\n      }\n    } else if (componentProps.showHistogram) {\n      var internalComponentID = getInternalComponentID(component);\n      var internalComponentValue = store.internalValues[internalComponentID];\n\n      if (!internalComponentValue) {\n        var histogramComponentID = getHistogramComponentID(component);\n        internalComponentValue = store.internalValues[histogramComponentID];\n      }\n\n      if (internalComponentValue && Array.isArray(internalComponentValue.value)) {\n        value = {\n          start: internalComponentValue.value[0],\n          end: internalComponentValue.value[1]\n        };\n        interval = getValidInterval(interval, value);\n      }\n    }\n\n    if (isDRSRangeComponent(component)) {\n      aggregations = ['min', 'max'];\n    } else if (componentProps.showHistogram) {\n      aggregations = ['histogram'];\n    }\n\n    if (componentProps.componentType === _constants.componentTypes.dynamicRangeSlider || componentProps.componentType === _constants.componentTypes.rangeSlider) {\n      calendarInterval = Object.keys(_dateFormats2.default).includes(queryFormat) ? componentProps.calendarInterval : undefined;\n\n      if (value) {\n        if ((0, _helper.isValidDateRangeQueryFormat)(componentProps.queryFormat)) {\n          value = {\n            start: (0, _helper.formatDate)(new _xdate2.default(value.start), componentProps),\n            end: (0, _helper.formatDate)(new _xdate2.default(value.end), componentProps)\n          };\n        } else {\n          value = {\n            start: parseFloat(value.start),\n            end: parseFloat(value.end)\n          };\n        }\n      }\n    }\n\n    if (dateRangeComponents.includes(componentProps.componentType)) {\n      queryFormat = 'or';\n\n      if (value) {\n        if (typeof value === 'string') {\n          value = {\n            start: (0, _helper.formatDate)(new _xdate2.default(value).addHours(-24), componentProps),\n            end: (0, _helper.formatDate)(new _xdate2.default(value), componentProps)\n          };\n        } else if (Array.isArray(value)) {\n          value = value.map(function (val) {\n            return {\n              start: (0, _helper.formatDate)(new _xdate2.default(val).addHours(-24), componentProps),\n              end: (0, _helper.formatDate)(new _xdate2.default(val), componentProps)\n            };\n          });\n        }\n      }\n    }\n  }\n\n  if (queryType === _constants.queryTypes.geo) {\n    value = undefined;\n    var geoCalcValues = store.selectedValues[component] || store.internalValues[component] || store.internalValues[getInternalComponentID(component)];\n\n    if (geoCalcValues && geoCalcValues.meta) {\n      if (geoCalcValues.meta.distance && geoCalcValues.meta.coordinates) {\n        value = {\n          distance: geoCalcValues.meta.distance,\n          location: geoCalcValues.meta.coordinates\n        };\n\n        if (componentProps.unit) {\n          value.unit = componentProps.unit;\n        }\n      }\n\n      if (geoCalcValues.meta.mapBoxBounds && geoCalcValues.meta.mapBoxBounds.top_left && geoCalcValues.meta.mapBoxBounds.bottom_right) {\n        value = {\n          geoBoundingBox: {\n            topLeft: geoCalcValues.meta.mapBoxBounds.top_left[1] + ', ' + geoCalcValues.meta.mapBoxBounds.top_left[0],\n            bottomRight: geoCalcValues.meta.mapBoxBounds.bottom_right[1] + ', ' + geoCalcValues.meta.mapBoxBounds.bottom_right[0]\n          }\n        };\n      }\n    }\n  }\n\n  if (componentProps.componentType === _constants.componentTypes.numberBox) {\n    if (queryFormat === 'exact') {\n      type = 'term';\n    } else {\n      type = 'range';\n\n      if (queryFormat === 'lte') {\n        value = {\n          end: value,\n          boost: 2.0\n        };\n      } else {\n        value = {\n          start: value,\n          boost: 2.0\n        };\n      }\n    }\n\n    queryFormat = 'or';\n  }\n\n  if (componentProps.componentType === _constants.componentTypes.reactiveComponent) {\n    type = 'term';\n    dataField = 'reactive_component_field';\n    value = undefined;\n  }\n\n  if (isSearchComponent(componentProps.componentType) && !value) {\n    value = '';\n  }\n\n  if (isComponentUsesLabelAsValue(componentProps.componentType)) {\n    var data = componentProps.data;\n    var absValue = [];\n\n    if (value && Array.isArray(value)) {\n      absValue = value;\n    } else if (value && typeof value === 'string') {\n      absValue = [value];\n    }\n\n    var normalizedValue = [];\n\n    if (absValue.length) {\n      if (data && Array.isArray(data)) {\n        absValue.forEach(function (val) {\n          var dataItem = data.find(function (o) {\n            return o.label === val;\n          });\n\n          if (dataItem && dataItem.value) {\n            normalizedValue.push(dataItem.value);\n          }\n        });\n      }\n    }\n\n    if (normalizedValue.length) {\n      value = normalizedValue;\n    } else {\n      value = undefined;\n    }\n  }\n\n  if (componentProps.componentType === _constants.componentTypes.reactiveList) {\n    if (value > 0) {\n      from = (value - 1) * (componentProps.size || 10);\n    }\n\n    value = undefined;\n  }\n\n  return _extends({}, componentProps, {\n    calendarInterval: calendarInterval,\n    dataField: dataField,\n    queryFormat: queryFormat,\n    type: type,\n    aggregations: aggregations,\n    interval: interval,\n    react: store.dependencyTree ? store.dependencyTree[component] : undefined,\n    customQuery: store.customQueries ? store.customQueries[component] : undefined,\n    defaultQuery: store.defaultQueries ? store.defaultQueries[component] : undefined,\n    customHighlight: store.customHighlightOptions ? store.customHighlightOptions[component] : undefined,\n    categoryValue: store.internalValues[component] ? store.internalValues[component].category : undefined,\n    value: componentProps.componentType === _constants.componentTypes.searchBox ? value || undefined : value,\n    pagination: pagination,\n    from: from\n  }, customOptions);\n};\n\nfunction flatReactProp(reactProp, componentID) {\n  var flattenReact = [];\n\n  var flatReact = function flatReact(react) {\n    if (react && Object.keys(react)) {\n      Object.keys(react).forEach(function (r) {\n        if (react[r]) {\n          if (typeof react[r] === 'string') {\n            flattenReact = [].concat(_toConsumableArray(flattenReact), [react[r]]);\n          } else if (Array.isArray(react[r])) {\n            flattenReact = [].concat(_toConsumableArray(flattenReact), _toConsumableArray(react[r]));\n          } else if (typeof react[r] === 'object') {\n            flatReact(react[r]);\n          }\n        }\n      });\n    }\n  };\n\n  flatReact(reactProp);\n  flattenReact = flattenReact.filter(function (react) {\n    return react !== componentID;\n  });\n  return flattenReact;\n}\n\nvar getDependentQueries = exports.getDependentQueries = function getDependentQueries(store, componentID) {\n  var orderOfQueries = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : [];\n  var finalQuery = {};\n  var react = flatReactProp(store.dependencyTree[componentID], componentID);\n  react.forEach(function (componentObject) {\n    var component = componentObject;\n    var customQuery = store.customQueries[component];\n\n    if (!isInternalComponent(component)) {\n      var calcValues = store.selectedValues[component] || store.internalValues[component];\n\n      if ((calcValues || customQuery) && !finalQuery[component]) {\n        var execute = false;\n\n        if (Array.isArray(orderOfQueries) && orderOfQueries.includes(component)) {\n          execute = true;\n        }\n\n        var componentProps = store.props[component];\n        var dependentQuery = getRSQuery(component, extractPropsFromState(store, component, _extends({}, componentProps && componentProps.componentType === _constants.componentTypes.searchBox ? _extends({}, execute === false ? {\n          type: _constants.queryTypes.search\n        } : {}, calcValues.category ? {\n          categoryValue: calcValues.category\n        } : {}) : {})), execute);\n\n        if (dependentQuery) {\n          finalQuery[component] = dependentQuery;\n        }\n      }\n    }\n  });\n  return finalQuery;\n};","map":{"version":3,"sources":["/Users/karina/Main/Study/Web Dev/test-api/node_modules/@appbaseio/reactivecore/lib/utils/transform.js"],"names":["Object","defineProperty","exports","value","getDependentQueries","extractPropsFromState","getValidInterval","getRSQuery","hasPaginationSupport","isComponentUsesLabelAsValue","isSearchComponent","isDRSRangeComponent","getHistogramComponentID","getInternalComponentID","isInternalComponent","getNormalizedField","componentToTypeMap","undefined","_extends","assign","target","i","arguments","length","source","key","prototype","hasOwnProperty","call","_componentToTypeMap","flatReactProp","_xdate","require","_xdate2","_interopRequireDefault","_constants","_dateFormats","_dateFormats2","_helper","obj","__esModule","default","_toConsumableArray","arr","Array","isArray","arr2","from","_defineProperty","enumerable","configurable","writable","componentTypes","reactiveList","queryTypes","search","dataSearch","categorySearch","searchBox","suggestion","singleList","term","multiList","singleDataList","singleDropdownList","multiDataList","multiDropdownList","tagCloud","toggleButton","numberBox","datePicker","range","dateRange","dynamicRangeSlider","singleDropdownRange","multiDropdownRange","singleRange","multiRange","rangeSlider","ratingsFilter","rangeInput","geoDistanceDropdown","geo","geoDistanceSlider","reactiveMap","multiRangeComponents","dateRangeComponents","searchComponents","listComponentsWithPagination","field","componentID","endsWith","componentType","includes","componentId","props","execute","queryType","type","dataField","id","react","highlight","highlightField","fuzziness","searchOperators","includeFields","excludeFields","size","aggregationSize","queryFormat","sortBy","fieldWeights","includeNullValues","aggregationField","categoryField","missingLabel","showMissing","nestedField","interval","customHighlight","customQuery","defaultQuery","categoryValue","after","aggregations","enableSynonyms","selectAllLabel","pagination","queryString","distinctField","distinctFieldConfig","index","enablePopularSuggestions","enableRecentSuggestions","popularSuggestionsConfig","recentSuggestionsConfig","applyStopwords","customStopwords","enablePredictiveSuggestions","calendarInterval","min","Math","ceil","end","start","store","component","customOptions","componentProps","calcValues","selectedValues","internalValues","showLoadMore","parsedValue","forEach","val","push","map","_ref","showHistogram","internalComponentID","internalComponentValue","histogramComponentID","keys","isValidDateRangeQueryFormat","formatDate","parseFloat","addHours","geoCalcValues","meta","distance","coordinates","location","unit","mapBoxBounds","top_left","bottom_right","geoBoundingBox","topLeft","bottomRight","boost","reactiveComponent","data","absValue","normalizedValue","dataItem","find","o","label","dependencyTree","customQueries","defaultQueries","customHighlightOptions","category","reactProp","flattenReact","flatReact","r","concat","filter","orderOfQueries","finalQuery","componentObject","dependentQuery"],"mappings":"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","sourcesContent":["Object.defineProperty(exports,\"__esModule\",{value:true});exports.getDependentQueries=exports.extractPropsFromState=exports.getValidInterval=exports.getRSQuery=exports.hasPaginationSupport=exports.isComponentUsesLabelAsValue=exports.isSearchComponent=exports.isDRSRangeComponent=exports.getHistogramComponentID=exports.getInternalComponentID=exports.isInternalComponent=exports.getNormalizedField=exports.componentToTypeMap=undefined;var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key];}}}return target;};var _componentToTypeMap;exports.flatReactProp=flatReactProp;var _xdate=require('xdate');var _xdate2=_interopRequireDefault(_xdate);var _constants=require('./constants');var _dateFormats=require('./dateFormats');var _dateFormats2=_interopRequireDefault(_dateFormats);var _helper=require('./helper');function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _toConsumableArray(arr){if(Array.isArray(arr)){for(var i=0,arr2=Array(arr.length);i<arr.length;i++){arr2[i]=arr[i];}return arr2;}else{return Array.from(arr);}}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true});}else{obj[key]=value;}return obj;}var componentToTypeMap=exports.componentToTypeMap=(_componentToTypeMap={},_defineProperty(_componentToTypeMap,_constants.componentTypes.reactiveList,_constants.queryTypes.search),_defineProperty(_componentToTypeMap,_constants.componentTypes.dataSearch,_constants.queryTypes.search),_defineProperty(_componentToTypeMap,_constants.componentTypes.categorySearch,_constants.queryTypes.search),_defineProperty(_componentToTypeMap,_constants.componentTypes.searchBox,_constants.queryTypes.suggestion),_defineProperty(_componentToTypeMap,_constants.componentTypes.singleList,_constants.queryTypes.term),_defineProperty(_componentToTypeMap,_constants.componentTypes.multiList,_constants.queryTypes.term),_defineProperty(_componentToTypeMap,_constants.componentTypes.singleDataList,_constants.queryTypes.term),_defineProperty(_componentToTypeMap,_constants.componentTypes.singleDropdownList,_constants.queryTypes.term),_defineProperty(_componentToTypeMap,_constants.componentTypes.multiDataList,_constants.queryTypes.term),_defineProperty(_componentToTypeMap,_constants.componentTypes.multiDropdownList,_constants.queryTypes.term),_defineProperty(_componentToTypeMap,_constants.componentTypes.tagCloud,_constants.queryTypes.term),_defineProperty(_componentToTypeMap,_constants.componentTypes.toggleButton,_constants.queryTypes.term),_defineProperty(_componentToTypeMap,_constants.componentTypes.numberBox,_constants.queryTypes.term),_defineProperty(_componentToTypeMap,_constants.componentTypes.datePicker,_constants.queryTypes.range),_defineProperty(_componentToTypeMap,_constants.componentTypes.dateRange,_constants.queryTypes.range),_defineProperty(_componentToTypeMap,_constants.componentTypes.dynamicRangeSlider,_constants.queryTypes.range),_defineProperty(_componentToTypeMap,_constants.componentTypes.singleDropdownRange,_constants.queryTypes.range),_defineProperty(_componentToTypeMap,_constants.componentTypes.multiDropdownRange,_constants.queryTypes.range),_defineProperty(_componentToTypeMap,_constants.componentTypes.singleRange,_constants.queryTypes.range),_defineProperty(_componentToTypeMap,_constants.componentTypes.multiRange,_constants.queryTypes.range),_defineProperty(_componentToTypeMap,_constants.componentTypes.rangeSlider,_constants.queryTypes.range),_defineProperty(_componentToTypeMap,_constants.componentTypes.ratingsFilter,_constants.queryTypes.range),_defineProperty(_componentToTypeMap,_constants.componentTypes.rangeInput,_constants.queryTypes.range),_defineProperty(_componentToTypeMap,_constants.componentTypes.geoDistanceDropdown,_constants.queryTypes.geo),_defineProperty(_componentToTypeMap,_constants.componentTypes.geoDistanceSlider,_constants.queryTypes.geo),_defineProperty(_componentToTypeMap,_constants.componentTypes.reactiveMap,_constants.queryTypes.geo),_componentToTypeMap);var multiRangeComponents=[_constants.componentTypes.multiRange,_constants.componentTypes.multiDropdownRange];var dateRangeComponents=[_constants.componentTypes.dateRange,_constants.componentTypes.datePicker];var searchComponents=[_constants.componentTypes.categorySearch,_constants.componentTypes.dataSearch,_constants.componentTypes.searchBox];var listComponentsWithPagination=[_constants.componentTypes.singleList,_constants.componentTypes.multiList,_constants.componentTypes.singleDropdownList,_constants.componentTypes.multiDropdownList];var getNormalizedField=exports.getNormalizedField=function getNormalizedField(field){if(field&&!Array.isArray(field)){return[field];}return field;};var isInternalComponent=exports.isInternalComponent=function isInternalComponent(){var componentID=arguments.length>0&&arguments[0]!==undefined?arguments[0]:'';return componentID.endsWith('__internal');};var getInternalComponentID=exports.getInternalComponentID=function getInternalComponentID(){var componentID=arguments.length>0&&arguments[0]!==undefined?arguments[0]:'';return componentID+'__internal';};var getHistogramComponentID=exports.getHistogramComponentID=function getHistogramComponentID(){var componentID=arguments.length>0&&arguments[0]!==undefined?arguments[0]:'';return componentID+'__histogram__internal';};var isDRSRangeComponent=exports.isDRSRangeComponent=function isDRSRangeComponent(){var componentID=arguments.length>0&&arguments[0]!==undefined?arguments[0]:'';return componentID.endsWith('__range__internal');};var isSearchComponent=exports.isSearchComponent=function isSearchComponent(){var componentType=arguments.length>0&&arguments[0]!==undefined?arguments[0]:'';return searchComponents.includes(componentType);};var isComponentUsesLabelAsValue=exports.isComponentUsesLabelAsValue=function isComponentUsesLabelAsValue(){var componentType=arguments.length>0&&arguments[0]!==undefined?arguments[0]:'';return componentType===_constants.componentTypes.multiDataList||componentType===_constants.componentTypes.singleDataList;};var hasPaginationSupport=exports.hasPaginationSupport=function hasPaginationSupport(){var componentType=arguments.length>0&&arguments[0]!==undefined?arguments[0]:'';return listComponentsWithPagination.includes(componentType);};var getRSQuery=exports.getRSQuery=function getRSQuery(componentId,props){var execute=arguments.length>2&&arguments[2]!==undefined?arguments[2]:true;if(props&&componentId){var queryType=props.type?props.type:componentToTypeMap[props.componentType];if(!isSearchComponent(props.componentType)&&!props.dataField){return null;}return _extends({id:componentId,type:queryType,dataField:getNormalizedField(props.dataField),execute:execute,react:props.react,highlight:props.highlight,highlightField:getNormalizedField(props.highlightField),fuzziness:props.fuzziness,searchOperators:props.searchOperators,includeFields:props.includeFields,excludeFields:props.excludeFields,size:props.size,aggregationSize:props.aggregationSize,from:props.from,queryFormat:props.queryFormat,sortBy:props.sortBy,fieldWeights:getNormalizedField(props.fieldWeights),includeNullValues:props.includeNullValues,aggregationField:props.aggregationField||undefined,categoryField:props.categoryField||undefined,missingLabel:props.missingLabel||undefined,showMissing:props.showMissing,nestedField:props.nestedField||undefined,interval:props.interval,customHighlight:props.customHighlight,customQuery:props.customQuery,defaultQuery:props.defaultQuery,value:props.value,categoryValue:props.categoryValue||undefined,after:props.after||undefined,aggregations:props.aggregations||undefined,enableSynonyms:props.enableSynonyms,selectAllLabel:props.selectAllLabel,pagination:props.pagination,queryString:props.queryString,distinctField:props.distinctField,distinctFieldConfig:props.distinctFieldConfig,index:props.index},queryType===_constants.queryTypes.suggestion?{enablePopularSuggestions:props.enablePopularSuggestions,enableRecentSuggestions:props.enableRecentSuggestions,popularSuggestionsConfig:props.popularSuggestionsConfig,recentSuggestionsConfig:props.recentSuggestionsConfig,applyStopwords:props.applyStopwords,customStopwords:props.customStopwords,enablePredictiveSuggestions:props.enablePredictiveSuggestions}:{},{calendarInterval:props.calendarInterval});}return null;};var getValidInterval=exports.getValidInterval=function getValidInterval(interval){var range=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var min=Math.ceil((range.end-range.start)/100)||1;if(!interval){return min;}else if(interval<min){return min;}return interval;};var extractPropsFromState=exports.extractPropsFromState=function extractPropsFromState(store,component,customOptions){var componentProps=store.props[component];if(!componentProps){return null;}var queryType=componentToTypeMap[componentProps.componentType];var calcValues=store.selectedValues[component]||store.internalValues[component];var value=calcValues!==undefined&&calcValues!==null?calcValues.value:undefined;var queryFormat=componentProps.queryFormat;var calendarInterval=void 0;var interval=componentProps.interval;var type=componentToTypeMap[componentProps.componentType];var dataField=componentProps.dataField;var aggregations=void 0;var pagination=void 0;var from=componentProps.from;if(queryType===_constants.queryTypes.term){if(componentProps.showLoadMore&&hasPaginationSupport(componentProps.componentType)){pagination=true;}if(value!=null&&typeof value==='object'&&value.value){value=value.value;}else if(Array.isArray(value)){var parsedValue=[];value.forEach(function(val){if(val!=null&&typeof val==='object'&&val.value){parsedValue.push(val.value);}else{parsedValue.push(val);}});value=parsedValue;}}if(queryType===_constants.queryTypes.range){if(Array.isArray(value)){if(multiRangeComponents.includes(componentProps.componentType)){value=value.map(function(_ref){var start=_ref.start,end=_ref.end;return{start:start,end:end};});}else{value={start:value[0],end:value[1]};}}else if(componentProps.showHistogram){var internalComponentID=getInternalComponentID(component);var internalComponentValue=store.internalValues[internalComponentID];if(!internalComponentValue){var histogramComponentID=getHistogramComponentID(component);internalComponentValue=store.internalValues[histogramComponentID];}if(internalComponentValue&&Array.isArray(internalComponentValue.value)){value={start:internalComponentValue.value[0],end:internalComponentValue.value[1]};interval=getValidInterval(interval,value);}}if(isDRSRangeComponent(component)){aggregations=['min','max'];}else if(componentProps.showHistogram){aggregations=['histogram'];}if(componentProps.componentType===_constants.componentTypes.dynamicRangeSlider||componentProps.componentType===_constants.componentTypes.rangeSlider){calendarInterval=Object.keys(_dateFormats2.default).includes(queryFormat)?componentProps.calendarInterval:undefined;if(value){if((0,_helper.isValidDateRangeQueryFormat)(componentProps.queryFormat)){value={start:(0,_helper.formatDate)(new _xdate2.default(value.start),componentProps),end:(0,_helper.formatDate)(new _xdate2.default(value.end),componentProps)};}else{value={start:parseFloat(value.start),end:parseFloat(value.end)};}}}if(dateRangeComponents.includes(componentProps.componentType)){queryFormat='or';if(value){if(typeof value==='string'){value={start:(0,_helper.formatDate)(new _xdate2.default(value).addHours(-24),componentProps),end:(0,_helper.formatDate)(new _xdate2.default(value),componentProps)};}else if(Array.isArray(value)){value=value.map(function(val){return{start:(0,_helper.formatDate)(new _xdate2.default(val).addHours(-24),componentProps),end:(0,_helper.formatDate)(new _xdate2.default(val),componentProps)};});}}}}if(queryType===_constants.queryTypes.geo){value=undefined;var geoCalcValues=store.selectedValues[component]||store.internalValues[component]||store.internalValues[getInternalComponentID(component)];if(geoCalcValues&&geoCalcValues.meta){if(geoCalcValues.meta.distance&&geoCalcValues.meta.coordinates){value={distance:geoCalcValues.meta.distance,location:geoCalcValues.meta.coordinates};if(componentProps.unit){value.unit=componentProps.unit;}}if(geoCalcValues.meta.mapBoxBounds&&geoCalcValues.meta.mapBoxBounds.top_left&&geoCalcValues.meta.mapBoxBounds.bottom_right){value={geoBoundingBox:{topLeft:geoCalcValues.meta.mapBoxBounds.top_left[1]+', '+geoCalcValues.meta.mapBoxBounds.top_left[0],bottomRight:geoCalcValues.meta.mapBoxBounds.bottom_right[1]+', '+geoCalcValues.meta.mapBoxBounds.bottom_right[0]}};}}}if(componentProps.componentType===_constants.componentTypes.numberBox){if(queryFormat==='exact'){type='term';}else{type='range';if(queryFormat==='lte'){value={end:value,boost:2.0};}else{value={start:value,boost:2.0};}}queryFormat='or';}if(componentProps.componentType===_constants.componentTypes.reactiveComponent){type='term';dataField='reactive_component_field';value=undefined;}if(isSearchComponent(componentProps.componentType)&&!value){value='';}if(isComponentUsesLabelAsValue(componentProps.componentType)){var data=componentProps.data;var absValue=[];if(value&&Array.isArray(value)){absValue=value;}else if(value&&typeof value==='string'){absValue=[value];}var normalizedValue=[];if(absValue.length){if(data&&Array.isArray(data)){absValue.forEach(function(val){var dataItem=data.find(function(o){return o.label===val;});if(dataItem&&dataItem.value){normalizedValue.push(dataItem.value);}});}}if(normalizedValue.length){value=normalizedValue;}else{value=undefined;}}if(componentProps.componentType===_constants.componentTypes.reactiveList){if(value>0){from=(value-1)*(componentProps.size||10);}value=undefined;}return _extends({},componentProps,{calendarInterval:calendarInterval,dataField:dataField,queryFormat:queryFormat,type:type,aggregations:aggregations,interval:interval,react:store.dependencyTree?store.dependencyTree[component]:undefined,customQuery:store.customQueries?store.customQueries[component]:undefined,defaultQuery:store.defaultQueries?store.defaultQueries[component]:undefined,customHighlight:store.customHighlightOptions?store.customHighlightOptions[component]:undefined,categoryValue:store.internalValues[component]?store.internalValues[component].category:undefined,value:componentProps.componentType===_constants.componentTypes.searchBox?value||undefined:value,pagination:pagination,from:from},customOptions);};function flatReactProp(reactProp,componentID){var flattenReact=[];var flatReact=function flatReact(react){if(react&&Object.keys(react)){Object.keys(react).forEach(function(r){if(react[r]){if(typeof react[r]==='string'){flattenReact=[].concat(_toConsumableArray(flattenReact),[react[r]]);}else if(Array.isArray(react[r])){flattenReact=[].concat(_toConsumableArray(flattenReact),_toConsumableArray(react[r]));}else if(typeof react[r]==='object'){flatReact(react[r]);}}});}};flatReact(reactProp);flattenReact=flattenReact.filter(function(react){return react!==componentID;});return flattenReact;}var getDependentQueries=exports.getDependentQueries=function getDependentQueries(store,componentID){var orderOfQueries=arguments.length>2&&arguments[2]!==undefined?arguments[2]:[];var finalQuery={};var react=flatReactProp(store.dependencyTree[componentID],componentID);react.forEach(function(componentObject){var component=componentObject;var customQuery=store.customQueries[component];if(!isInternalComponent(component)){var calcValues=store.selectedValues[component]||store.internalValues[component];if((calcValues||customQuery)&&!finalQuery[component]){var execute=false;if(Array.isArray(orderOfQueries)&&orderOfQueries.includes(component)){execute=true;}var componentProps=store.props[component];var dependentQuery=getRSQuery(component,extractPropsFromState(store,component,_extends({},componentProps&&componentProps.componentType===_constants.componentTypes.searchBox?_extends({},execute===false?{type:_constants.queryTypes.search}:{},calcValues.category?{categoryValue:calcValues.category}:{}):{})),execute);if(dependentQuery){finalQuery[component]=dependentQuery;}}}});return finalQuery;};"]},"metadata":{},"sourceType":"script"}