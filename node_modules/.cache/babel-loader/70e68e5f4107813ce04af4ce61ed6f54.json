{"ast":null,"code":"'use strict';\n\nexports.__esModule = true;\n\nvar _extends = Object.assign || function (target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i];\n\n    for (var key in source) {\n      if (Object.prototype.hasOwnProperty.call(source, key)) {\n        target[key] = source[key];\n      }\n    }\n  }\n\n  return target;\n};\n\nvar _createClass = function () {\n  function defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descriptor);\n    }\n  }\n\n  return function (Constructor, protoProps, staticProps) {\n    if (protoProps) defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) defineProperties(Constructor, staticProps);\n    return Constructor;\n  };\n}();\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _actions = require('@appbaseio/reactivecore/lib/actions');\n\nvar _helper = require('@appbaseio/reactivecore/lib/utils/helper');\n\nvar _types = require('@appbaseio/reactivecore/lib/utils/types');\n\nvar _types2 = _interopRequireDefault(_types);\n\nvar _transform = require('@appbaseio/reactivecore/lib/utils/transform');\n\nvar _constants = require('@appbaseio/reactivecore/lib/utils/constants');\n\nvar _utils = require('../../utils');\n\nvar _ComponentWrapper = require('../basic/ComponentWrapper');\n\nvar _ComponentWrapper2 = _interopRequireDefault(_ComponentWrapper);\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction _objectWithoutProperties(obj, keys) {\n  var target = {};\n\n  for (var i in obj) {\n    if (keys.indexOf(i) >= 0) continue;\n    if (!Object.prototype.hasOwnProperty.call(obj, i)) continue;\n    target[i] = obj[i];\n  }\n\n  return target;\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (!self) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self;\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass);\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      enumerable: false,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;\n}\n\nvar ReactiveComponent = function (_Component) {\n  _inherits(ReactiveComponent, _Component);\n\n  function ReactiveComponent(props) {\n    _classCallCheck(this, ReactiveComponent);\n\n    var _this = _possibleConstructorReturn(this, _Component.call(this, props));\n\n    _this.getAggsQuery = function () {\n      if (_this.props.aggregationField) {\n        return (0, _helper.getCompositeAggsQuery)({\n          props: _this.props,\n          showTopHits: true,\n          value: _this.props.value\n        });\n      }\n\n      return {};\n    };\n\n    _this.internalComponent = null;\n    _this.defaultQuery = null;\n\n    _this.setQuery = function (data) {\n      if (!data) {\n        console.error('setQuery accepts the arguments of shape { query, options, value }.');\n        return;\n      }\n\n      var options = data.options,\n          obj = _objectWithoutProperties(data, ['options']);\n\n      if (options) {\n        props.setQueryOptions(props.componentId, _extends({}, options, _this.getAggsQuery()), false);\n      }\n\n      var queryToBeSet = obj.query; // when enableAppbase is true, Backend throws error because of repeated query in request body\n\n      if (obj && obj.query && obj.query.query) {\n        queryToBeSet = obj.query.query;\n      } // Update customQuery field for RS API\n\n\n      if (obj && obj.query || options) {\n        var customQuery = _extends({}, options);\n\n        if (obj && obj.query) {\n          if (obj.query.id) {\n            customQuery = queryToBeSet;\n          } else {\n            customQuery.query = queryToBeSet;\n          }\n        }\n\n        props.setCustomQuery(props.componentId, customQuery);\n      }\n\n      if (!queryToBeSet && data && data.id) {\n        queryToBeSet = data;\n      }\n\n      _this.props.updateQuery(_extends({}, obj, {\n        query: queryToBeSet,\n        componentId: props.componentId,\n        label: props.filterLabel,\n        showFilter: props.showFilter,\n        URLParams: props.URLParams\n      }));\n    };\n\n    if (props.defaultQuery) {\n      _this.internalComponent = (0, _transform.getInternalComponentID)(props.componentId);\n    } // Set custom and default queries in store\n\n\n    (0, _helper.updateCustomQuery)(props.componentId, props, _this.props.selectedValue);\n    (0, _helper.updateDefaultQuery)(props.componentId, props, _this.props.selectedValue);\n\n    if (_this.internalComponent && props.defaultQuery) {\n      _this.defaultQuery = props.defaultQuery(_this.props.selectedValue, _this.props);\n\n      var _ref = _this.defaultQuery || {},\n          query = _ref.query;\n\n      var defaultQueryOptions = _this.defaultQuery ? (0, _helper.getOptionsFromQuery)(_this.defaultQuery) : null;\n\n      if (defaultQueryOptions) {\n        props.setQueryOptions(_this.internalComponent, _extends({}, defaultQueryOptions, _this.getAggsQuery()), false);\n      } else _this.props.setQueryOptions(_this.internalComponent, _this.getAggsQuery());\n\n      var queryToSet = query || null;\n\n      if (!queryToSet && _this.defaultQuery && _this.defaultQuery.id) {\n        queryToSet = _this.defaultQuery;\n      }\n\n      props.updateQuery({\n        componentId: _this.internalComponent,\n        query: queryToSet\n      });\n    }\n\n    return _this;\n  }\n\n  ReactiveComponent.prototype.componentDidMount = function componentDidMount() {\n    var _props = this.props,\n        customQuery = _props.customQuery,\n        selectedValue = _props.selectedValue,\n        value = _props.value,\n        defaultValue = _props.defaultValue,\n        componentId = _props.componentId,\n        filterLabel = _props.filterLabel,\n        showFilter = _props.showFilter,\n        URLParams = _props.URLParams,\n        aggregationField = _props.aggregationField,\n        config = _props.config,\n        distinctField = _props.distinctField,\n        distinctFieldConfig = _props.distinctFieldConfig,\n        index = _props.index;\n    var initialValue = selectedValue || value || defaultValue || null;\n    var enableAppbase = config.enableAppbase;\n\n    if (enableAppbase && aggregationField) {\n      console.warn('Warning(ReactiveSearch): The `aggregationField` prop has been marked as deprecated, please use the `distinctField` prop instead.');\n    }\n\n    if (!enableAppbase && (distinctField || distinctFieldConfig)) {\n      console.warn('Warning(ReactiveSearch): In order to use the `distinctField` and `distinctFieldConfig` props, the `enableAppbase` prop must be set to true in `ReactiveBase`.');\n    }\n\n    if (!enableAppbase && index) {\n      console.warn('Warning(ReactiveSearch): In order to use the `index` prop, the `enableAppbase` prop must be set to true in `ReactiveBase`.');\n    }\n\n    if (customQuery) {\n      var calcCustomQuery = customQuery(this.props.selectedValue, this.props);\n\n      var _ref2 = calcCustomQuery || {},\n          query = _ref2.query;\n\n      var customQueryOptions = calcCustomQuery ? (0, _helper.getOptionsFromQuery)(calcCustomQuery) : null;\n\n      if (customQueryOptions) {\n        this.props.setQueryOptions(componentId, _extends({}, customQueryOptions, this.getAggsQuery()), false);\n      } else this.props.setQueryOptions(componentId, this.getAggsQuery(), false);\n\n      this.props.updateQuery({\n        componentId: componentId,\n        query: query,\n        value: initialValue,\n        label: filterLabel,\n        showFilter: showFilter,\n        URLParams: URLParams\n      });\n    }\n  };\n\n  ReactiveComponent.prototype.componentDidUpdate = function componentDidUpdate(prevProps) {\n    var _this2 = this; // only consider hits and defaultQuery when customQuery is absent\n\n\n    if (this.props.onData) {\n      (0, _helper.checkSomePropChange)(this.props, prevProps, ['hits', 'aggregations', 'promotedResults', 'total', 'time', 'hidden'], function () {\n        _this2.props.onData(_this2.getData());\n      });\n    }\n\n    (0, _helper.checkPropChange)(this.props.selectedValue, prevProps.selectedValue, function () {\n      /*\n      \tReset query when SelectedFilters are clicked. Note: `selectedValue` becomes null.\n      */\n      if (_this2.props.selectedValue === null) {\n        _this2.props.updateQuery({\n          componentId: _this2.props.componentId,\n          query: null,\n          URLParams: _this2.props.URLParams\n        });\n      }\n    });\n\n    if (this.props.defaultQuery && !(0, _helper.isEqual)(this.props.defaultQuery(this.props.selectedValue, this.props), this.defaultQuery)) {\n      this.defaultQuery = this.props.defaultQuery(this.props.selectedValue, this.props);\n\n      var _ref3 = this.defaultQuery || {},\n          query = _ref3.query,\n          queryOptions = _objectWithoutProperties(_ref3, ['query']);\n\n      if (queryOptions) {\n        this.props.setQueryOptions(this.internalComponent, _extends({}, queryOptions, this.getAggsQuery()), false);\n      } else this.props.setQueryOptions(this.internalComponent, this.getAggsQuery(), false);\n\n      (0, _helper.updateDefaultQuery)(this.props.componentId, this.props, this.props.selectedValue);\n      var queryToSet = query || null;\n\n      if (!queryToSet && this.defaultQuery && this.defaultQuery.id) {\n        queryToSet = this.defaultQuery;\n      }\n\n      this.props.updateQuery({\n        componentId: this.internalComponent,\n        query: queryToSet\n      });\n    }\n\n    if (this.props.customQuery && !(0, _helper.isEqual)(this.props.customQuery(this.props.selectedValue, this.props), prevProps.customQuery(this.props.selectedValue, this.props))) {\n      var _ref4 = this.props.customQuery(this.props.selectedValue, this.props) || {},\n          _query = _ref4.query,\n          _queryOptions = _objectWithoutProperties(_ref4, ['query']);\n\n      if (_queryOptions) {\n        this.props.setQueryOptions(this.props.componentId, _extends({}, _queryOptions, this.getAggsQuery()), false);\n      } else this.props.setQueryOptions(this.props.componentId, this.getAggsQuery(), false);\n\n      (0, _helper.updateCustomQuery)(this.props.componentId, this.props, this.props.selectedValue);\n\n      var _queryToSet = _query || null;\n\n      if (!_queryToSet && _queryOptions && _queryOptions.id) {\n        _queryToSet = _queryOptions;\n      }\n\n      this.props.updateQuery({\n        componentId: this.props.componentId,\n        query: _queryToSet,\n        URLParams: this.props.URLParams\n      });\n    }\n  };\n\n  ReactiveComponent.prototype.getData = function getData() {\n    var _props2 = this.props,\n        hits = _props2.hits,\n        aggregations = _props2.aggregations,\n        aggregationData = _props2.aggregationData,\n        promotedResults = _props2.promotedResults,\n        rawData = _props2.rawData;\n    var filteredResults = (0, _helper.parseHits)(hits);\n\n    if (promotedResults.length) {\n      var ids = promotedResults.map(function (item) {\n        return item._id;\n      }).filter(Boolean);\n\n      if (ids) {\n        filteredResults = filteredResults.filter(function (item) {\n          return !ids.includes(item._id);\n        });\n      }\n\n      filteredResults = [].concat(promotedResults, filteredResults);\n    }\n\n    return {\n      data: filteredResults,\n      promotedData: promotedResults,\n      aggregationData: aggregationData || [],\n      rawData: rawData,\n      aggregations: aggregations,\n      resultStats: this.stats\n    };\n  };\n\n  ReactiveComponent.prototype.getComponent = function getComponent() {\n    var _props3 = this.props,\n        error = _props3.error,\n        isLoading = _props3.isLoading,\n        selectedValue = _props3.selectedValue;\n\n    var data = _extends({\n      error: error,\n      loading: isLoading\n    }, this.getData(), {\n      value: selectedValue,\n      setQuery: this.setQuery\n    });\n\n    return (0, _utils.getComponent)(data, this.props);\n  };\n\n  ReactiveComponent.prototype.render = function render() {\n    if ((0, _utils.hasCustomRenderer)(this.props)) {\n      return this.getComponent();\n    }\n\n    return null;\n  };\n\n  _createClass(ReactiveComponent, [{\n    key: 'stats',\n    get: function get() {\n      return (0, _helper.getResultStats)(this.props);\n    }\n  }]);\n\n  return ReactiveComponent;\n}(_react.Component);\n\nReactiveComponent.defaultProps = {\n  showFilter: true,\n  URLParams: false,\n  size: 20\n};\nReactiveComponent.propTypes = {\n  error: _types2.default.title,\n  setQueryOptions: _types2.default.funcRequired,\n  updateQuery: _types2.default.funcRequired,\n  aggregationField: _types2.default.string,\n  aggregationSize: _types2.default.number,\n  size: _types2.default.number,\n  aggregations: _types2.default.selectedValues,\n  aggregationData: _types2.default.aggregationData,\n  hits: _types2.default.data,\n  rawData: _types2.default.rawData,\n  promotedResults: _types2.default.hits,\n  isLoading: _types2.default.bool,\n  selectedValue: _types2.default.selectedValue,\n  setCustomQuery: _types2.default.funcRequired,\n  // component props\n  children: _types2.default.func,\n  componentId: _types2.default.stringRequired,\n  defaultQuery: _types2.default.func,\n  customQuery: _types2.default.func,\n  defaultValue: _types2.default.any,\n  // eslint-disable-line\n  value: _types2.default.any,\n  // eslint-disable-line\n  filterLabel: _types2.default.string,\n  onQueryChange: _types2.default.func,\n  onError: _types2.default.func,\n  react: _types2.default.react,\n  render: _types2.default.func,\n  showFilter: _types2.default.bool,\n  URLParams: _types2.default.bool,\n  onData: _types2.default.func,\n  distinctField: _types2.default.string,\n  distinctFieldConfig: _types2.default.componentObject,\n  config: _types2.default.props,\n  index: _types2.default.string\n}; // Add componentType for SSR\n\nReactiveComponent.componentType = _constants.componentTypes.reactiveComponent;\n\nvar mapStateToProps = function mapStateToProps(state, props) {\n  return {\n    aggregations: state.aggregations[props.componentId] && state.aggregations[props.componentId] || null,\n    aggregationData: state.compositeAggregations[props.componentId] || [],\n    hits: state.hits[props.componentId] && state.hits[props.componentId].hits || [],\n    rawData: state.rawData[props.componentId],\n    selectedValue: state.selectedValues[props.componentId] && state.selectedValues[props.componentId].value || null,\n    isLoading: state.isLoading[props.componentId],\n    error: state.error[props.componentId],\n    promotedResults: state.promotedResults[props.componentId] || [],\n    time: state.hits[props.componentId] && state.hits[props.componentId].time || 0,\n    total: state.hits[props.componentId] && state.hits[props.componentId].total,\n    hidden: state.hits[props.componentId] && state.hits[props.componentId].hidden,\n    config: state.config\n  };\n};\n\nvar mapDispatchtoProps = function mapDispatchtoProps(dispatch) {\n  return {\n    setCustomQuery: function setCustomQuery(component, query) {\n      return dispatch((0, _actions.setCustomQuery)(component, query));\n    },\n    setDefaultQuery: function setDefaultQuery(component, query) {\n      return dispatch((0, _actions.setDefaultQuery)(component, query));\n    },\n    setQueryOptions: function setQueryOptions(component, props, execute) {\n      return dispatch((0, _actions.setQueryOptions)(component, props, execute));\n    },\n    updateQuery: function updateQuery(updateQueryObject) {\n      return dispatch((0, _actions.updateQuery)(updateQueryObject));\n    }\n  };\n};\n\nvar ConnectedComponent = (0, _utils.connect)(mapStateToProps, mapDispatchtoProps)(function (props) {\n  return _react2.default.createElement(_ComponentWrapper2.default, _extends({}, props, {\n    internalComponent: !!props.defaultQuery,\n    componentType: _constants.componentTypes.reactiveComponent\n  }), function () {\n    return _react2.default.createElement(ReactiveComponent, _extends({\n      ref: props.myForwardedRef\n    }, props));\n  });\n}); // eslint-disable-next-line\n\nvar ForwardRefComponent = _react2.default.forwardRef(function (props, ref) {\n  return _react2.default.createElement(ConnectedComponent, _extends({}, props, {\n    myForwardedRef: ref\n  }));\n});\n\nForwardRefComponent.displayName = 'ReactiveComponent';\nexports.default = ForwardRefComponent;","map":{"version":3,"sources":["/Users/karina/Main/Study/Web Dev/test-api/node_modules/@appbaseio/reactivesearch/lib/components/basic/ReactiveComponent.js"],"names":["exports","__esModule","_extends","Object","assign","target","i","arguments","length","source","key","prototype","hasOwnProperty","call","_createClass","defineProperties","props","descriptor","enumerable","configurable","writable","defineProperty","Constructor","protoProps","staticProps","_react","require","_react2","_interopRequireDefault","_actions","_helper","_types","_types2","_transform","_constants","_utils","_ComponentWrapper","_ComponentWrapper2","obj","default","_objectWithoutProperties","keys","indexOf","_classCallCheck","instance","TypeError","_possibleConstructorReturn","self","ReferenceError","_inherits","subClass","superClass","create","constructor","value","setPrototypeOf","__proto__","ReactiveComponent","_Component","_this","getAggsQuery","aggregationField","getCompositeAggsQuery","showTopHits","internalComponent","defaultQuery","setQuery","data","console","error","options","setQueryOptions","componentId","queryToBeSet","query","customQuery","id","setCustomQuery","updateQuery","label","filterLabel","showFilter","URLParams","getInternalComponentID","updateCustomQuery","selectedValue","updateDefaultQuery","_ref","defaultQueryOptions","getOptionsFromQuery","queryToSet","componentDidMount","_props","defaultValue","config","distinctField","distinctFieldConfig","index","initialValue","enableAppbase","warn","calcCustomQuery","_ref2","customQueryOptions","componentDidUpdate","prevProps","_this2","onData","checkSomePropChange","getData","checkPropChange","isEqual","_ref3","queryOptions","_ref4","_query","_queryOptions","_queryToSet","_props2","hits","aggregations","aggregationData","promotedResults","rawData","filteredResults","parseHits","ids","map","item","_id","filter","Boolean","includes","concat","promotedData","resultStats","stats","getComponent","_props3","isLoading","loading","render","hasCustomRenderer","get","getResultStats","Component","defaultProps","size","propTypes","title","funcRequired","string","aggregationSize","number","selectedValues","bool","children","func","stringRequired","any","onQueryChange","onError","react","componentObject","componentType","componentTypes","reactiveComponent","mapStateToProps","state","compositeAggregations","time","total","hidden","mapDispatchtoProps","dispatch","component","setDefaultQuery","execute","updateQueryObject","ConnectedComponent","connect","createElement","ref","myForwardedRef","ForwardRefComponent","forwardRef","displayName"],"mappings":"AAAA;;AAEAA,OAAO,CAACC,UAAR,GAAqB,IAArB;;AAEA,IAAIC,QAAQ,GAAGC,MAAM,CAACC,MAAP,IAAiB,UAAUC,MAAV,EAAkB;AAAE,OAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGC,SAAS,CAACC,MAA9B,EAAsCF,CAAC,EAAvC,EAA2C;AAAE,QAAIG,MAAM,GAAGF,SAAS,CAACD,CAAD,CAAtB;;AAA2B,SAAK,IAAII,GAAT,IAAgBD,MAAhB,EAAwB;AAAE,UAAIN,MAAM,CAACQ,SAAP,CAAiBC,cAAjB,CAAgCC,IAAhC,CAAqCJ,MAArC,EAA6CC,GAA7C,CAAJ,EAAuD;AAAEL,QAAAA,MAAM,CAACK,GAAD,CAAN,GAAcD,MAAM,CAACC,GAAD,CAApB;AAA4B;AAAE;AAAE;;AAAC,SAAOL,MAAP;AAAgB,CAAhQ;;AAEA,IAAIS,YAAY,GAAG,YAAY;AAAE,WAASC,gBAAT,CAA0BV,MAA1B,EAAkCW,KAAlC,EAAyC;AAAE,SAAK,IAAIV,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGU,KAAK,CAACR,MAA1B,EAAkCF,CAAC,EAAnC,EAAuC;AAAE,UAAIW,UAAU,GAAGD,KAAK,CAACV,CAAD,CAAtB;AAA2BW,MAAAA,UAAU,CAACC,UAAX,GAAwBD,UAAU,CAACC,UAAX,IAAyB,KAAjD;AAAwDD,MAAAA,UAAU,CAACE,YAAX,GAA0B,IAA1B;AAAgC,UAAI,WAAWF,UAAf,EAA2BA,UAAU,CAACG,QAAX,GAAsB,IAAtB;AAA4BjB,MAAAA,MAAM,CAACkB,cAAP,CAAsBhB,MAAtB,EAA8BY,UAAU,CAACP,GAAzC,EAA8CO,UAA9C;AAA4D;AAAE;;AAAC,SAAO,UAAUK,WAAV,EAAuBC,UAAvB,EAAmCC,WAAnC,EAAgD;AAAE,QAAID,UAAJ,EAAgBR,gBAAgB,CAACO,WAAW,CAACX,SAAb,EAAwBY,UAAxB,CAAhB;AAAqD,QAAIC,WAAJ,EAAiBT,gBAAgB,CAACO,WAAD,EAAcE,WAAd,CAAhB;AAA4C,WAAOF,WAAP;AAAqB,GAAhN;AAAmN,CAA9hB,EAAnB;;AAEA,IAAIG,MAAM,GAAGC,OAAO,CAAC,OAAD,CAApB;;AAEA,IAAIC,OAAO,GAAGC,sBAAsB,CAACH,MAAD,CAApC;;AAEA,IAAII,QAAQ,GAAGH,OAAO,CAAC,qCAAD,CAAtB;;AAEA,IAAII,OAAO,GAAGJ,OAAO,CAAC,0CAAD,CAArB;;AAEA,IAAIK,MAAM,GAAGL,OAAO,CAAC,yCAAD,CAApB;;AAEA,IAAIM,OAAO,GAAGJ,sBAAsB,CAACG,MAAD,CAApC;;AAEA,IAAIE,UAAU,GAAGP,OAAO,CAAC,6CAAD,CAAxB;;AAEA,IAAIQ,UAAU,GAAGR,OAAO,CAAC,6CAAD,CAAxB;;AAEA,IAAIS,MAAM,GAAGT,OAAO,CAAC,aAAD,CAApB;;AAEA,IAAIU,iBAAiB,GAAGV,OAAO,CAAC,2BAAD,CAA/B;;AAEA,IAAIW,kBAAkB,GAAGT,sBAAsB,CAACQ,iBAAD,CAA/C;;AAEA,SAASR,sBAAT,CAAgCU,GAAhC,EAAqC;AAAE,SAAOA,GAAG,IAAIA,GAAG,CAACrC,UAAX,GAAwBqC,GAAxB,GAA8B;AAAEC,IAAAA,OAAO,EAAED;AAAX,GAArC;AAAwD;;AAE/F,SAASE,wBAAT,CAAkCF,GAAlC,EAAuCG,IAAvC,EAA6C;AAAE,MAAIpC,MAAM,GAAG,EAAb;;AAAiB,OAAK,IAAIC,CAAT,IAAcgC,GAAd,EAAmB;AAAE,QAAIG,IAAI,CAACC,OAAL,CAAapC,CAAb,KAAmB,CAAvB,EAA0B;AAAU,QAAI,CAACH,MAAM,CAACQ,SAAP,CAAiBC,cAAjB,CAAgCC,IAAhC,CAAqCyB,GAArC,EAA0ChC,CAA1C,CAAL,EAAmD;AAAUD,IAAAA,MAAM,CAACC,CAAD,CAAN,GAAYgC,GAAG,CAAChC,CAAD,CAAf;AAAqB;;AAAC,SAAOD,MAAP;AAAgB;;AAE5N,SAASsC,eAAT,CAAyBC,QAAzB,EAAmCtB,WAAnC,EAAgD;AAAE,MAAI,EAAEsB,QAAQ,YAAYtB,WAAtB,CAAJ,EAAwC;AAAE,UAAM,IAAIuB,SAAJ,CAAc,mCAAd,CAAN;AAA2D;AAAE;;AAEzJ,SAASC,0BAAT,CAAoCC,IAApC,EAA0ClC,IAA1C,EAAgD;AAAE,MAAI,CAACkC,IAAL,EAAW;AAAE,UAAM,IAAIC,cAAJ,CAAmB,2DAAnB,CAAN;AAAwF;;AAAC,SAAOnC,IAAI,KAAK,OAAOA,IAAP,KAAgB,QAAhB,IAA4B,OAAOA,IAAP,KAAgB,UAAjD,CAAJ,GAAmEA,IAAnE,GAA0EkC,IAAjF;AAAwF;;AAEhP,SAASE,SAAT,CAAmBC,QAAnB,EAA6BC,UAA7B,EAAyC;AAAE,MAAI,OAAOA,UAAP,KAAsB,UAAtB,IAAoCA,UAAU,KAAK,IAAvD,EAA6D;AAAE,UAAM,IAAIN,SAAJ,CAAc,6DAA6D,OAAOM,UAAlF,CAAN;AAAsG;;AAACD,EAAAA,QAAQ,CAACvC,SAAT,GAAqBR,MAAM,CAACiD,MAAP,CAAcD,UAAU,IAAIA,UAAU,CAACxC,SAAvC,EAAkD;AAAE0C,IAAAA,WAAW,EAAE;AAAEC,MAAAA,KAAK,EAAEJ,QAAT;AAAmBhC,MAAAA,UAAU,EAAE,KAA/B;AAAsCE,MAAAA,QAAQ,EAAE,IAAhD;AAAsDD,MAAAA,YAAY,EAAE;AAApE;AAAf,GAAlD,CAArB;AAAqK,MAAIgC,UAAJ,EAAgBhD,MAAM,CAACoD,cAAP,GAAwBpD,MAAM,CAACoD,cAAP,CAAsBL,QAAtB,EAAgCC,UAAhC,CAAxB,GAAsED,QAAQ,CAACM,SAAT,GAAqBL,UAA3F;AAAwG;;AAE9e,IAAIM,iBAAiB,GAAG,UAAUC,UAAV,EAAsB;AAC7CT,EAAAA,SAAS,CAACQ,iBAAD,EAAoBC,UAApB,CAAT;;AAEA,WAASD,iBAAT,CAA2BzC,KAA3B,EAAkC;AACjC2B,IAAAA,eAAe,CAAC,IAAD,EAAOc,iBAAP,CAAf;;AAEA,QAAIE,KAAK,GAAGb,0BAA0B,CAAC,IAAD,EAAOY,UAAU,CAAC7C,IAAX,CAAgB,IAAhB,EAAsBG,KAAtB,CAAP,CAAtC;;AAEA2C,IAAAA,KAAK,CAACC,YAAN,GAAqB,YAAY;AAChC,UAAID,KAAK,CAAC3C,KAAN,CAAY6C,gBAAhB,EAAkC;AACjC,eAAO,CAAC,GAAG/B,OAAO,CAACgC,qBAAZ,EAAmC;AACzC9C,UAAAA,KAAK,EAAE2C,KAAK,CAAC3C,KAD4B;AAEzC+C,UAAAA,WAAW,EAAE,IAF4B;AAGzCT,UAAAA,KAAK,EAAEK,KAAK,CAAC3C,KAAN,CAAYsC;AAHsB,SAAnC,CAAP;AAKA;;AACD,aAAO,EAAP;AACA,KATD;;AAWAK,IAAAA,KAAK,CAACK,iBAAN,GAA0B,IAA1B;AACAL,IAAAA,KAAK,CAACM,YAAN,GAAqB,IAArB;;AACAN,IAAAA,KAAK,CAACO,QAAN,GAAiB,UAAUC,IAAV,EAAgB;AAChC,UAAI,CAACA,IAAL,EAAW;AACVC,QAAAA,OAAO,CAACC,KAAR,CAAc,oEAAd;AACA;AACA;;AAED,UAAIC,OAAO,GAAGH,IAAI,CAACG,OAAnB;AAAA,UACIhC,GAAG,GAAGE,wBAAwB,CAAC2B,IAAD,EAAO,CAAC,SAAD,CAAP,CADlC;;AAGA,UAAIG,OAAJ,EAAa;AACZtD,QAAAA,KAAK,CAACuD,eAAN,CAAsBvD,KAAK,CAACwD,WAA5B,EAAyCtE,QAAQ,CAAC,EAAD,EAAKoE,OAAL,EAAcX,KAAK,CAACC,YAAN,EAAd,CAAjD,EAAsF,KAAtF;AACA;;AAED,UAAIa,YAAY,GAAGnC,GAAG,CAACoC,KAAvB,CAbgC,CAehC;;AACA,UAAIpC,GAAG,IAAIA,GAAG,CAACoC,KAAX,IAAoBpC,GAAG,CAACoC,KAAJ,CAAUA,KAAlC,EAAyC;AACxCD,QAAAA,YAAY,GAAGnC,GAAG,CAACoC,KAAJ,CAAUA,KAAzB;AACA,OAlB+B,CAoBhC;;;AACA,UAAIpC,GAAG,IAAIA,GAAG,CAACoC,KAAX,IAAoBJ,OAAxB,EAAiC;AAChC,YAAIK,WAAW,GAAGzE,QAAQ,CAAC,EAAD,EAAKoE,OAAL,CAA1B;;AACA,YAAIhC,GAAG,IAAIA,GAAG,CAACoC,KAAf,EAAsB;AACrB,cAAIpC,GAAG,CAACoC,KAAJ,CAAUE,EAAd,EAAkB;AACjBD,YAAAA,WAAW,GAAGF,YAAd;AACA,WAFD,MAEO;AACNE,YAAAA,WAAW,CAACD,KAAZ,GAAoBD,YAApB;AACA;AACD;;AACDzD,QAAAA,KAAK,CAAC6D,cAAN,CAAqB7D,KAAK,CAACwD,WAA3B,EAAwCG,WAAxC;AACA;;AACD,UAAI,CAACF,YAAD,IAAiBN,IAAjB,IAAyBA,IAAI,CAACS,EAAlC,EAAsC;AACrCH,QAAAA,YAAY,GAAGN,IAAf;AACA;;AAEDR,MAAAA,KAAK,CAAC3C,KAAN,CAAY8D,WAAZ,CAAwB5E,QAAQ,CAAC,EAAD,EAAKoC,GAAL,EAAU;AACzCoC,QAAAA,KAAK,EAAED,YADkC;AAEzCD,QAAAA,WAAW,EAAExD,KAAK,CAACwD,WAFsB;AAGzCO,QAAAA,KAAK,EAAE/D,KAAK,CAACgE,WAH4B;AAIzCC,QAAAA,UAAU,EAAEjE,KAAK,CAACiE,UAJuB;AAKzCC,QAAAA,SAAS,EAAElE,KAAK,CAACkE;AALwB,OAAV,CAAhC;AAOA,KA3CD;;AA6CA,QAAIlE,KAAK,CAACiD,YAAV,EAAwB;AACvBN,MAAAA,KAAK,CAACK,iBAAN,GAA0B,CAAC,GAAG/B,UAAU,CAACkD,sBAAf,EAAuCnE,KAAK,CAACwD,WAA7C,CAA1B;AACA,KAjEgC,CAmEjC;;;AACA,KAAC,GAAG1C,OAAO,CAACsD,iBAAZ,EAA+BpE,KAAK,CAACwD,WAArC,EAAkDxD,KAAlD,EAAyD2C,KAAK,CAAC3C,KAAN,CAAYqE,aAArE;AACA,KAAC,GAAGvD,OAAO,CAACwD,kBAAZ,EAAgCtE,KAAK,CAACwD,WAAtC,EAAmDxD,KAAnD,EAA0D2C,KAAK,CAAC3C,KAAN,CAAYqE,aAAtE;;AAEA,QAAI1B,KAAK,CAACK,iBAAN,IAA2BhD,KAAK,CAACiD,YAArC,EAAmD;AAClDN,MAAAA,KAAK,CAACM,YAAN,GAAqBjD,KAAK,CAACiD,YAAN,CAAmBN,KAAK,CAAC3C,KAAN,CAAYqE,aAA/B,EAA8C1B,KAAK,CAAC3C,KAApD,CAArB;;AAEA,UAAIuE,IAAI,GAAG5B,KAAK,CAACM,YAAN,IAAsB,EAAjC;AAAA,UACIS,KAAK,GAAGa,IAAI,CAACb,KADjB;;AAGA,UAAIc,mBAAmB,GAAG7B,KAAK,CAACM,YAAN,GAAqB,CAAC,GAAGnC,OAAO,CAAC2D,mBAAZ,EAAiC9B,KAAK,CAACM,YAAvC,CAArB,GAA4E,IAAtG;;AAEA,UAAIuB,mBAAJ,EAAyB;AACxBxE,QAAAA,KAAK,CAACuD,eAAN,CAAsBZ,KAAK,CAACK,iBAA5B,EAA+C9D,QAAQ,CAAC,EAAD,EAAKsF,mBAAL,EAA0B7B,KAAK,CAACC,YAAN,EAA1B,CAAvD,EAAwG,KAAxG;AACA,OAFD,MAEOD,KAAK,CAAC3C,KAAN,CAAYuD,eAAZ,CAA4BZ,KAAK,CAACK,iBAAlC,EAAqDL,KAAK,CAACC,YAAN,EAArD;;AAEP,UAAI8B,UAAU,GAAGhB,KAAK,IAAI,IAA1B;;AACA,UAAI,CAACgB,UAAD,IAAe/B,KAAK,CAACM,YAArB,IAAqCN,KAAK,CAACM,YAAN,CAAmBW,EAA5D,EAAgE;AAC/Dc,QAAAA,UAAU,GAAG/B,KAAK,CAACM,YAAnB;AACA;;AACDjD,MAAAA,KAAK,CAAC8D,WAAN,CAAkB;AACjBN,QAAAA,WAAW,EAAEb,KAAK,CAACK,iBADF;AAEjBU,QAAAA,KAAK,EAAEgB;AAFU,OAAlB;AAIA;;AACD,WAAO/B,KAAP;AACA;;AAEDF,EAAAA,iBAAiB,CAAC9C,SAAlB,CAA4BgF,iBAA5B,GAAgD,SAASA,iBAAT,GAA6B;AAC5E,QAAIC,MAAM,GAAG,KAAK5E,KAAlB;AAAA,QACI2D,WAAW,GAAGiB,MAAM,CAACjB,WADzB;AAAA,QAEIU,aAAa,GAAGO,MAAM,CAACP,aAF3B;AAAA,QAGI/B,KAAK,GAAGsC,MAAM,CAACtC,KAHnB;AAAA,QAIIuC,YAAY,GAAGD,MAAM,CAACC,YAJ1B;AAAA,QAKIrB,WAAW,GAAGoB,MAAM,CAACpB,WALzB;AAAA,QAMIQ,WAAW,GAAGY,MAAM,CAACZ,WANzB;AAAA,QAOIC,UAAU,GAAGW,MAAM,CAACX,UAPxB;AAAA,QAQIC,SAAS,GAAGU,MAAM,CAACV,SARvB;AAAA,QASIrB,gBAAgB,GAAG+B,MAAM,CAAC/B,gBAT9B;AAAA,QAUIiC,MAAM,GAAGF,MAAM,CAACE,MAVpB;AAAA,QAWIC,aAAa,GAAGH,MAAM,CAACG,aAX3B;AAAA,QAYIC,mBAAmB,GAAGJ,MAAM,CAACI,mBAZjC;AAAA,QAaIC,KAAK,GAAGL,MAAM,CAACK,KAbnB;AAeA,QAAIC,YAAY,GAAGb,aAAa,IAAI/B,KAAjB,IAA0BuC,YAA1B,IAA0C,IAA7D;AACA,QAAIM,aAAa,GAAGL,MAAM,CAACK,aAA3B;;AAGA,QAAIA,aAAa,IAAItC,gBAArB,EAAuC;AACtCO,MAAAA,OAAO,CAACgC,IAAR,CAAa,kIAAb;AACA;;AACD,QAAI,CAACD,aAAD,KAAmBJ,aAAa,IAAIC,mBAApC,CAAJ,EAA8D;AAC7D5B,MAAAA,OAAO,CAACgC,IAAR,CAAa,+JAAb;AACA;;AACD,QAAI,CAACD,aAAD,IAAkBF,KAAtB,EAA6B;AAC5B7B,MAAAA,OAAO,CAACgC,IAAR,CAAa,4HAAb;AACA;;AAED,QAAIzB,WAAJ,EAAiB;AAChB,UAAI0B,eAAe,GAAG1B,WAAW,CAAC,KAAK3D,KAAL,CAAWqE,aAAZ,EAA2B,KAAKrE,KAAhC,CAAjC;;AAEA,UAAIsF,KAAK,GAAGD,eAAe,IAAI,EAA/B;AAAA,UACI3B,KAAK,GAAG4B,KAAK,CAAC5B,KADlB;;AAGA,UAAI6B,kBAAkB,GAAGF,eAAe,GAAG,CAAC,GAAGvE,OAAO,CAAC2D,mBAAZ,EAAiCY,eAAjC,CAAH,GAAuD,IAA/F;;AACA,UAAIE,kBAAJ,EAAwB;AACvB,aAAKvF,KAAL,CAAWuD,eAAX,CAA2BC,WAA3B,EAAwCtE,QAAQ,CAAC,EAAD,EAAKqG,kBAAL,EAAyB,KAAK3C,YAAL,EAAzB,CAAhD,EAA+F,KAA/F;AACA,OAFD,MAEO,KAAK5C,KAAL,CAAWuD,eAAX,CAA2BC,WAA3B,EAAwC,KAAKZ,YAAL,EAAxC,EAA6D,KAA7D;;AACP,WAAK5C,KAAL,CAAW8D,WAAX,CAAuB;AACtBN,QAAAA,WAAW,EAAEA,WADS;AAEtBE,QAAAA,KAAK,EAAEA,KAFe;AAGtBpB,QAAAA,KAAK,EAAE4C,YAHe;AAItBnB,QAAAA,KAAK,EAAEC,WAJe;AAKtBC,QAAAA,UAAU,EAAEA,UALU;AAMtBC,QAAAA,SAAS,EAAEA;AANW,OAAvB;AAQA;AACD,GAjDD;;AAmDAzB,EAAAA,iBAAiB,CAAC9C,SAAlB,CAA4B6F,kBAA5B,GAAiD,SAASA,kBAAT,CAA4BC,SAA5B,EAAuC;AACvF,QAAIC,MAAM,GAAG,IAAb,CADuF,CAGvF;;;AACA,QAAI,KAAK1F,KAAL,CAAW2F,MAAf,EAAuB;AACtB,OAAC,GAAG7E,OAAO,CAAC8E,mBAAZ,EAAiC,KAAK5F,KAAtC,EAA6CyF,SAA7C,EAAwD,CAAC,MAAD,EAAS,cAAT,EAAyB,iBAAzB,EAA4C,OAA5C,EAAqD,MAArD,EAA6D,QAA7D,CAAxD,EAAgI,YAAY;AAC3IC,QAAAA,MAAM,CAAC1F,KAAP,CAAa2F,MAAb,CAAoBD,MAAM,CAACG,OAAP,EAApB;AACA,OAFD;AAGA;;AAED,KAAC,GAAG/E,OAAO,CAACgF,eAAZ,EAA6B,KAAK9F,KAAL,CAAWqE,aAAxC,EAAuDoB,SAAS,CAACpB,aAAjE,EAAgF,YAAY;AAC3F;AACH;AACA;AAEG,UAAIqB,MAAM,CAAC1F,KAAP,CAAaqE,aAAb,KAA+B,IAAnC,EAAyC;AACxCqB,QAAAA,MAAM,CAAC1F,KAAP,CAAa8D,WAAb,CAAyB;AACxBN,UAAAA,WAAW,EAAEkC,MAAM,CAAC1F,KAAP,CAAawD,WADF;AAExBE,UAAAA,KAAK,EAAE,IAFiB;AAGxBQ,UAAAA,SAAS,EAAEwB,MAAM,CAAC1F,KAAP,CAAakE;AAHA,SAAzB;AAKA;AACD,KAZD;;AAaA,QAAI,KAAKlE,KAAL,CAAWiD,YAAX,IAA2B,CAAC,CAAC,GAAGnC,OAAO,CAACiF,OAAZ,EAAqB,KAAK/F,KAAL,CAAWiD,YAAX,CAAwB,KAAKjD,KAAL,CAAWqE,aAAnC,EAAkD,KAAKrE,KAAvD,CAArB,EAAoF,KAAKiD,YAAzF,CAAhC,EAAwI;AACvI,WAAKA,YAAL,GAAoB,KAAKjD,KAAL,CAAWiD,YAAX,CAAwB,KAAKjD,KAAL,CAAWqE,aAAnC,EAAkD,KAAKrE,KAAvD,CAApB;;AAEA,UAAIgG,KAAK,GAAG,KAAK/C,YAAL,IAAqB,EAAjC;AAAA,UACIS,KAAK,GAAGsC,KAAK,CAACtC,KADlB;AAAA,UAEIuC,YAAY,GAAGzE,wBAAwB,CAACwE,KAAD,EAAQ,CAAC,OAAD,CAAR,CAF3C;;AAIA,UAAIC,YAAJ,EAAkB;AACjB,aAAKjG,KAAL,CAAWuD,eAAX,CAA2B,KAAKP,iBAAhC,EAAmD9D,QAAQ,CAAC,EAAD,EAAK+G,YAAL,EAAmB,KAAKrD,YAAL,EAAnB,CAA3D,EAAoG,KAApG;AACA,OAFD,MAEO,KAAK5C,KAAL,CAAWuD,eAAX,CAA2B,KAAKP,iBAAhC,EAAmD,KAAKJ,YAAL,EAAnD,EAAwE,KAAxE;;AACP,OAAC,GAAG9B,OAAO,CAACwD,kBAAZ,EAAgC,KAAKtE,KAAL,CAAWwD,WAA3C,EAAwD,KAAKxD,KAA7D,EAAoE,KAAKA,KAAL,CAAWqE,aAA/E;AACA,UAAIK,UAAU,GAAGhB,KAAK,IAAI,IAA1B;;AACA,UAAI,CAACgB,UAAD,IAAe,KAAKzB,YAApB,IAAoC,KAAKA,YAAL,CAAkBW,EAA1D,EAA8D;AAC7Dc,QAAAA,UAAU,GAAG,KAAKzB,YAAlB;AACA;;AACD,WAAKjD,KAAL,CAAW8D,WAAX,CAAuB;AACtBN,QAAAA,WAAW,EAAE,KAAKR,iBADI;AAEtBU,QAAAA,KAAK,EAAEgB;AAFe,OAAvB;AAIA;;AAED,QAAI,KAAK1E,KAAL,CAAW2D,WAAX,IAA0B,CAAC,CAAC,GAAG7C,OAAO,CAACiF,OAAZ,EAAqB,KAAK/F,KAAL,CAAW2D,WAAX,CAAuB,KAAK3D,KAAL,CAAWqE,aAAlC,EAAiD,KAAKrE,KAAtD,CAArB,EAAmFyF,SAAS,CAAC9B,WAAV,CAAsB,KAAK3D,KAAL,CAAWqE,aAAjC,EAAgD,KAAKrE,KAArD,CAAnF,CAA/B,EAAgL;AAC/K,UAAIkG,KAAK,GAAG,KAAKlG,KAAL,CAAW2D,WAAX,CAAuB,KAAK3D,KAAL,CAAWqE,aAAlC,EAAiD,KAAKrE,KAAtD,KAAgE,EAA5E;AAAA,UACImG,MAAM,GAAGD,KAAK,CAACxC,KADnB;AAAA,UAEI0C,aAAa,GAAG5E,wBAAwB,CAAC0E,KAAD,EAAQ,CAAC,OAAD,CAAR,CAF5C;;AAIA,UAAIE,aAAJ,EAAmB;AAClB,aAAKpG,KAAL,CAAWuD,eAAX,CAA2B,KAAKvD,KAAL,CAAWwD,WAAtC,EAAmDtE,QAAQ,CAAC,EAAD,EAAKkH,aAAL,EAAoB,KAAKxD,YAAL,EAApB,CAA3D,EAAqG,KAArG;AACA,OAFD,MAEO,KAAK5C,KAAL,CAAWuD,eAAX,CAA2B,KAAKvD,KAAL,CAAWwD,WAAtC,EAAmD,KAAKZ,YAAL,EAAnD,EAAwE,KAAxE;;AACP,OAAC,GAAG9B,OAAO,CAACsD,iBAAZ,EAA+B,KAAKpE,KAAL,CAAWwD,WAA1C,EAAuD,KAAKxD,KAA5D,EAAmE,KAAKA,KAAL,CAAWqE,aAA9E;;AACA,UAAIgC,WAAW,GAAGF,MAAM,IAAI,IAA5B;;AACA,UAAI,CAACE,WAAD,IAAgBD,aAAhB,IAAiCA,aAAa,CAACxC,EAAnD,EAAuD;AACtDyC,QAAAA,WAAW,GAAGD,aAAd;AACA;;AACD,WAAKpG,KAAL,CAAW8D,WAAX,CAAuB;AACtBN,QAAAA,WAAW,EAAE,KAAKxD,KAAL,CAAWwD,WADF;AAEtBE,QAAAA,KAAK,EAAE2C,WAFe;AAGtBnC,QAAAA,SAAS,EAAE,KAAKlE,KAAL,CAAWkE;AAHA,OAAvB;AAKA;AACD,GA/DD;;AAiEAzB,EAAAA,iBAAiB,CAAC9C,SAAlB,CAA4BkG,OAA5B,GAAsC,SAASA,OAAT,GAAmB;AACxD,QAAIS,OAAO,GAAG,KAAKtG,KAAnB;AAAA,QACIuG,IAAI,GAAGD,OAAO,CAACC,IADnB;AAAA,QAEIC,YAAY,GAAGF,OAAO,CAACE,YAF3B;AAAA,QAGIC,eAAe,GAAGH,OAAO,CAACG,eAH9B;AAAA,QAIIC,eAAe,GAAGJ,OAAO,CAACI,eAJ9B;AAAA,QAKIC,OAAO,GAAGL,OAAO,CAACK,OALtB;AAOA,QAAIC,eAAe,GAAG,CAAC,GAAG9F,OAAO,CAAC+F,SAAZ,EAAuBN,IAAvB,CAAtB;;AACA,QAAIG,eAAe,CAAClH,MAApB,EAA4B;AAC3B,UAAIsH,GAAG,GAAGJ,eAAe,CAACK,GAAhB,CAAoB,UAAUC,IAAV,EAAgB;AAC7C,eAAOA,IAAI,CAACC,GAAZ;AACA,OAFS,EAEPC,MAFO,CAEAC,OAFA,CAAV;;AAGA,UAAIL,GAAJ,EAAS;AACRF,QAAAA,eAAe,GAAGA,eAAe,CAACM,MAAhB,CAAuB,UAAUF,IAAV,EAAgB;AACxD,iBAAO,CAACF,GAAG,CAACM,QAAJ,CAAaJ,IAAI,CAACC,GAAlB,CAAR;AACA,SAFiB,CAAlB;AAGA;;AACDL,MAAAA,eAAe,GAAG,GAAGS,MAAH,CAAUX,eAAV,EAA2BE,eAA3B,CAAlB;AACA;;AACD,WAAO;AACNzD,MAAAA,IAAI,EAAEyD,eADA;AAENU,MAAAA,YAAY,EAAEZ,eAFR;AAGND,MAAAA,eAAe,EAAEA,eAAe,IAAI,EAH9B;AAINE,MAAAA,OAAO,EAAEA,OAJH;AAKNH,MAAAA,YAAY,EAAEA,YALR;AAMNe,MAAAA,WAAW,EAAE,KAAKC;AANZ,KAAP;AAQA,GA5BD;;AA8BA/E,EAAAA,iBAAiB,CAAC9C,SAAlB,CAA4B8H,YAA5B,GAA2C,SAASA,YAAT,GAAwB;AAClE,QAAIC,OAAO,GAAG,KAAK1H,KAAnB;AAAA,QACIqD,KAAK,GAAGqE,OAAO,CAACrE,KADpB;AAAA,QAEIsE,SAAS,GAAGD,OAAO,CAACC,SAFxB;AAAA,QAGItD,aAAa,GAAGqD,OAAO,CAACrD,aAH5B;;AAKA,QAAIlB,IAAI,GAAGjE,QAAQ,CAAC;AACnBmE,MAAAA,KAAK,EAAEA,KADY;AAEnBuE,MAAAA,OAAO,EAAED;AAFU,KAAD,EAGhB,KAAK9B,OAAL,EAHgB,EAGA;AAClBvD,MAAAA,KAAK,EAAE+B,aADW;AAElBnB,MAAAA,QAAQ,EAAE,KAAKA;AAFG,KAHA,CAAnB;;AAOA,WAAO,CAAC,GAAG/B,MAAM,CAACsG,YAAX,EAAyBtE,IAAzB,EAA+B,KAAKnD,KAApC,CAAP;AACA,GAdD;;AAgBAyC,EAAAA,iBAAiB,CAAC9C,SAAlB,CAA4BkI,MAA5B,GAAqC,SAASA,MAAT,GAAkB;AACtD,QAAI,CAAC,GAAG1G,MAAM,CAAC2G,iBAAX,EAA8B,KAAK9H,KAAnC,CAAJ,EAA+C;AAC9C,aAAO,KAAKyH,YAAL,EAAP;AACA;;AACD,WAAO,IAAP;AACA,GALD;;AAOA3H,EAAAA,YAAY,CAAC2C,iBAAD,EAAoB,CAAC;AAChC/C,IAAAA,GAAG,EAAE,OAD2B;AAEhCqI,IAAAA,GAAG,EAAE,SAASA,GAAT,GAAe;AACnB,aAAO,CAAC,GAAGjH,OAAO,CAACkH,cAAZ,EAA4B,KAAKhI,KAAjC,CAAP;AACA;AAJ+B,GAAD,CAApB,CAAZ;;AAOA,SAAOyC,iBAAP;AACA,CAnRuB,CAmRtBhC,MAAM,CAACwH,SAnRe,CAAxB;;AAqRAxF,iBAAiB,CAACyF,YAAlB,GAAiC;AAChCjE,EAAAA,UAAU,EAAE,IADoB;AAEhCC,EAAAA,SAAS,EAAE,KAFqB;AAGhCiE,EAAAA,IAAI,EAAE;AAH0B,CAAjC;AAMA1F,iBAAiB,CAAC2F,SAAlB,GAA8B;AAC7B/E,EAAAA,KAAK,EAAErC,OAAO,CAACO,OAAR,CAAgB8G,KADM;AAE7B9E,EAAAA,eAAe,EAAEvC,OAAO,CAACO,OAAR,CAAgB+G,YAFJ;AAG7BxE,EAAAA,WAAW,EAAE9C,OAAO,CAACO,OAAR,CAAgB+G,YAHA;AAI7BzF,EAAAA,gBAAgB,EAAE7B,OAAO,CAACO,OAAR,CAAgBgH,MAJL;AAK7BC,EAAAA,eAAe,EAAExH,OAAO,CAACO,OAAR,CAAgBkH,MALJ;AAM7BN,EAAAA,IAAI,EAAEnH,OAAO,CAACO,OAAR,CAAgBkH,MANO;AAO7BjC,EAAAA,YAAY,EAAExF,OAAO,CAACO,OAAR,CAAgBmH,cAPD;AAQ7BjC,EAAAA,eAAe,EAAEzF,OAAO,CAACO,OAAR,CAAgBkF,eARJ;AAS7BF,EAAAA,IAAI,EAAEvF,OAAO,CAACO,OAAR,CAAgB4B,IATO;AAU7BwD,EAAAA,OAAO,EAAE3F,OAAO,CAACO,OAAR,CAAgBoF,OAVI;AAW7BD,EAAAA,eAAe,EAAE1F,OAAO,CAACO,OAAR,CAAgBgF,IAXJ;AAY7BoB,EAAAA,SAAS,EAAE3G,OAAO,CAACO,OAAR,CAAgBoH,IAZE;AAa7BtE,EAAAA,aAAa,EAAErD,OAAO,CAACO,OAAR,CAAgB8C,aAbF;AAc7BR,EAAAA,cAAc,EAAE7C,OAAO,CAACO,OAAR,CAAgB+G,YAdH;AAe7B;AACAM,EAAAA,QAAQ,EAAE5H,OAAO,CAACO,OAAR,CAAgBsH,IAhBG;AAiB7BrF,EAAAA,WAAW,EAAExC,OAAO,CAACO,OAAR,CAAgBuH,cAjBA;AAkB7B7F,EAAAA,YAAY,EAAEjC,OAAO,CAACO,OAAR,CAAgBsH,IAlBD;AAmB7BlF,EAAAA,WAAW,EAAE3C,OAAO,CAACO,OAAR,CAAgBsH,IAnBA;AAoB7BhE,EAAAA,YAAY,EAAE7D,OAAO,CAACO,OAAR,CAAgBwH,GApBD;AAoBM;AACnCzG,EAAAA,KAAK,EAAEtB,OAAO,CAACO,OAAR,CAAgBwH,GArBM;AAqBD;AAC5B/E,EAAAA,WAAW,EAAEhD,OAAO,CAACO,OAAR,CAAgBgH,MAtBA;AAuB7BS,EAAAA,aAAa,EAAEhI,OAAO,CAACO,OAAR,CAAgBsH,IAvBF;AAwB7BI,EAAAA,OAAO,EAAEjI,OAAO,CAACO,OAAR,CAAgBsH,IAxBI;AAyB7BK,EAAAA,KAAK,EAAElI,OAAO,CAACO,OAAR,CAAgB2H,KAzBM;AA0B7BrB,EAAAA,MAAM,EAAE7G,OAAO,CAACO,OAAR,CAAgBsH,IA1BK;AA2B7B5E,EAAAA,UAAU,EAAEjD,OAAO,CAACO,OAAR,CAAgBoH,IA3BC;AA4B7BzE,EAAAA,SAAS,EAAElD,OAAO,CAACO,OAAR,CAAgBoH,IA5BE;AA6B7BhD,EAAAA,MAAM,EAAE3E,OAAO,CAACO,OAAR,CAAgBsH,IA7BK;AA8B7B9D,EAAAA,aAAa,EAAE/D,OAAO,CAACO,OAAR,CAAgBgH,MA9BF;AA+B7BvD,EAAAA,mBAAmB,EAAEhE,OAAO,CAACO,OAAR,CAAgB4H,eA/BR;AAgC7BrE,EAAAA,MAAM,EAAE9D,OAAO,CAACO,OAAR,CAAgBvB,KAhCK;AAiC7BiF,EAAAA,KAAK,EAAEjE,OAAO,CAACO,OAAR,CAAgBgH;AAjCM,CAA9B,C,CAoCA;;AACA9F,iBAAiB,CAAC2G,aAAlB,GAAkClI,UAAU,CAACmI,cAAX,CAA0BC,iBAA5D;;AAEA,IAAIC,eAAe,GAAG,SAASA,eAAT,CAAyBC,KAAzB,EAAgCxJ,KAAhC,EAAuC;AAC5D,SAAO;AACNwG,IAAAA,YAAY,EAAEgD,KAAK,CAAChD,YAAN,CAAmBxG,KAAK,CAACwD,WAAzB,KAAyCgG,KAAK,CAAChD,YAAN,CAAmBxG,KAAK,CAACwD,WAAzB,CAAzC,IAAkF,IAD1F;AAENiD,IAAAA,eAAe,EAAE+C,KAAK,CAACC,qBAAN,CAA4BzJ,KAAK,CAACwD,WAAlC,KAAkD,EAF7D;AAGN+C,IAAAA,IAAI,EAAEiD,KAAK,CAACjD,IAAN,CAAWvG,KAAK,CAACwD,WAAjB,KAAiCgG,KAAK,CAACjD,IAAN,CAAWvG,KAAK,CAACwD,WAAjB,EAA8B+C,IAA/D,IAAuE,EAHvE;AAINI,IAAAA,OAAO,EAAE6C,KAAK,CAAC7C,OAAN,CAAc3G,KAAK,CAACwD,WAApB,CAJH;AAKNa,IAAAA,aAAa,EAAEmF,KAAK,CAACd,cAAN,CAAqB1I,KAAK,CAACwD,WAA3B,KAA2CgG,KAAK,CAACd,cAAN,CAAqB1I,KAAK,CAACwD,WAA3B,EAAwClB,KAAnF,IAA4F,IALrG;AAMNqF,IAAAA,SAAS,EAAE6B,KAAK,CAAC7B,SAAN,CAAgB3H,KAAK,CAACwD,WAAtB,CANL;AAONH,IAAAA,KAAK,EAAEmG,KAAK,CAACnG,KAAN,CAAYrD,KAAK,CAACwD,WAAlB,CAPD;AAQNkD,IAAAA,eAAe,EAAE8C,KAAK,CAAC9C,eAAN,CAAsB1G,KAAK,CAACwD,WAA5B,KAA4C,EARvD;AASNkG,IAAAA,IAAI,EAAEF,KAAK,CAACjD,IAAN,CAAWvG,KAAK,CAACwD,WAAjB,KAAiCgG,KAAK,CAACjD,IAAN,CAAWvG,KAAK,CAACwD,WAAjB,EAA8BkG,IAA/D,IAAuE,CATvE;AAUNC,IAAAA,KAAK,EAAEH,KAAK,CAACjD,IAAN,CAAWvG,KAAK,CAACwD,WAAjB,KAAiCgG,KAAK,CAACjD,IAAN,CAAWvG,KAAK,CAACwD,WAAjB,EAA8BmG,KAVhE;AAWNC,IAAAA,MAAM,EAAEJ,KAAK,CAACjD,IAAN,CAAWvG,KAAK,CAACwD,WAAjB,KAAiCgG,KAAK,CAACjD,IAAN,CAAWvG,KAAK,CAACwD,WAAjB,EAA8BoG,MAXjE;AAYN9E,IAAAA,MAAM,EAAE0E,KAAK,CAAC1E;AAZR,GAAP;AAcA,CAfD;;AAiBA,IAAI+E,kBAAkB,GAAG,SAASA,kBAAT,CAA4BC,QAA5B,EAAsC;AAC9D,SAAO;AACNjG,IAAAA,cAAc,EAAE,SAASA,cAAT,CAAwBkG,SAAxB,EAAmCrG,KAAnC,EAA0C;AACzD,aAAOoG,QAAQ,CAAC,CAAC,GAAGjJ,QAAQ,CAACgD,cAAb,EAA6BkG,SAA7B,EAAwCrG,KAAxC,CAAD,CAAf;AACA,KAHK;AAINsG,IAAAA,eAAe,EAAE,SAASA,eAAT,CAAyBD,SAAzB,EAAoCrG,KAApC,EAA2C;AAC3D,aAAOoG,QAAQ,CAAC,CAAC,GAAGjJ,QAAQ,CAACmJ,eAAb,EAA8BD,SAA9B,EAAyCrG,KAAzC,CAAD,CAAf;AACA,KANK;AAONH,IAAAA,eAAe,EAAE,SAASA,eAAT,CAAyBwG,SAAzB,EAAoC/J,KAApC,EAA2CiK,OAA3C,EAAoD;AACpE,aAAOH,QAAQ,CAAC,CAAC,GAAGjJ,QAAQ,CAAC0C,eAAb,EAA8BwG,SAA9B,EAAyC/J,KAAzC,EAAgDiK,OAAhD,CAAD,CAAf;AACA,KATK;AAUNnG,IAAAA,WAAW,EAAE,SAASA,WAAT,CAAqBoG,iBAArB,EAAwC;AACpD,aAAOJ,QAAQ,CAAC,CAAC,GAAGjJ,QAAQ,CAACiD,WAAb,EAA0BoG,iBAA1B,CAAD,CAAf;AACA;AAZK,GAAP;AAcA,CAfD;;AAiBA,IAAIC,kBAAkB,GAAG,CAAC,GAAGhJ,MAAM,CAACiJ,OAAX,EAAoBb,eAApB,EAAqCM,kBAArC,EAAyD,UAAU7J,KAAV,EAAiB;AAClG,SAAOW,OAAO,CAACY,OAAR,CAAgB8I,aAAhB,CACNhJ,kBAAkB,CAACE,OADb,EAENrC,QAAQ,CAAC,EAAD,EAAKc,KAAL,EAAY;AACnBgD,IAAAA,iBAAiB,EAAE,CAAC,CAAChD,KAAK,CAACiD,YADR;AAEnBmG,IAAAA,aAAa,EAAElI,UAAU,CAACmI,cAAX,CAA0BC;AAFtB,GAAZ,CAFF,EAMN,YAAY;AACX,WAAO3I,OAAO,CAACY,OAAR,CAAgB8I,aAAhB,CAA8B5H,iBAA9B,EAAiDvD,QAAQ,CAAC;AAAEoL,MAAAA,GAAG,EAAEtK,KAAK,CAACuK;AAAb,KAAD,EAAgCvK,KAAhC,CAAzD,CAAP;AACA,GARK,CAAP;AAUA,CAXwB,CAAzB,C,CAaA;;AACA,IAAIwK,mBAAmB,GAAG7J,OAAO,CAACY,OAAR,CAAgBkJ,UAAhB,CAA2B,UAAUzK,KAAV,EAAiBsK,GAAjB,EAAsB;AAC1E,SAAO3J,OAAO,CAACY,OAAR,CAAgB8I,aAAhB,CAA8BF,kBAA9B,EAAkDjL,QAAQ,CAAC,EAAD,EAAKc,KAAL,EAAY;AAAEuK,IAAAA,cAAc,EAAED;AAAlB,GAAZ,CAA1D,CAAP;AACA,CAFyB,CAA1B;;AAIAE,mBAAmB,CAACE,WAApB,GAAkC,mBAAlC;AACA1L,OAAO,CAACuC,OAAR,GAAkBiJ,mBAAlB","sourcesContent":["'use strict';\n\nexports.__esModule = true;\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _actions = require('@appbaseio/reactivecore/lib/actions');\n\nvar _helper = require('@appbaseio/reactivecore/lib/utils/helper');\n\nvar _types = require('@appbaseio/reactivecore/lib/utils/types');\n\nvar _types2 = _interopRequireDefault(_types);\n\nvar _transform = require('@appbaseio/reactivecore/lib/utils/transform');\n\nvar _constants = require('@appbaseio/reactivecore/lib/utils/constants');\n\nvar _utils = require('../../utils');\n\nvar _ComponentWrapper = require('../basic/ComponentWrapper');\n\nvar _ComponentWrapper2 = _interopRequireDefault(_ComponentWrapper);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _objectWithoutProperties(obj, keys) { var target = {}; for (var i in obj) { if (keys.indexOf(i) >= 0) continue; if (!Object.prototype.hasOwnProperty.call(obj, i)) continue; target[i] = obj[i]; } return target; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar ReactiveComponent = function (_Component) {\n\t_inherits(ReactiveComponent, _Component);\n\n\tfunction ReactiveComponent(props) {\n\t\t_classCallCheck(this, ReactiveComponent);\n\n\t\tvar _this = _possibleConstructorReturn(this, _Component.call(this, props));\n\n\t\t_this.getAggsQuery = function () {\n\t\t\tif (_this.props.aggregationField) {\n\t\t\t\treturn (0, _helper.getCompositeAggsQuery)({\n\t\t\t\t\tprops: _this.props,\n\t\t\t\t\tshowTopHits: true,\n\t\t\t\t\tvalue: _this.props.value\n\t\t\t\t});\n\t\t\t}\n\t\t\treturn {};\n\t\t};\n\n\t\t_this.internalComponent = null;\n\t\t_this.defaultQuery = null;\n\t\t_this.setQuery = function (data) {\n\t\t\tif (!data) {\n\t\t\t\tconsole.error('setQuery accepts the arguments of shape { query, options, value }.');\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvar options = data.options,\n\t\t\t    obj = _objectWithoutProperties(data, ['options']);\n\n\t\t\tif (options) {\n\t\t\t\tprops.setQueryOptions(props.componentId, _extends({}, options, _this.getAggsQuery()), false);\n\t\t\t}\n\n\t\t\tvar queryToBeSet = obj.query;\n\n\t\t\t// when enableAppbase is true, Backend throws error because of repeated query in request body\n\t\t\tif (obj && obj.query && obj.query.query) {\n\t\t\t\tqueryToBeSet = obj.query.query;\n\t\t\t}\n\n\t\t\t// Update customQuery field for RS API\n\t\t\tif (obj && obj.query || options) {\n\t\t\t\tvar customQuery = _extends({}, options);\n\t\t\t\tif (obj && obj.query) {\n\t\t\t\t\tif (obj.query.id) {\n\t\t\t\t\t\tcustomQuery = queryToBeSet;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcustomQuery.query = queryToBeSet;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tprops.setCustomQuery(props.componentId, customQuery);\n\t\t\t}\n\t\t\tif (!queryToBeSet && data && data.id) {\n\t\t\t\tqueryToBeSet = data;\n\t\t\t}\n\n\t\t\t_this.props.updateQuery(_extends({}, obj, {\n\t\t\t\tquery: queryToBeSet,\n\t\t\t\tcomponentId: props.componentId,\n\t\t\t\tlabel: props.filterLabel,\n\t\t\t\tshowFilter: props.showFilter,\n\t\t\t\tURLParams: props.URLParams\n\t\t\t}));\n\t\t};\n\n\t\tif (props.defaultQuery) {\n\t\t\t_this.internalComponent = (0, _transform.getInternalComponentID)(props.componentId);\n\t\t}\n\n\t\t// Set custom and default queries in store\n\t\t(0, _helper.updateCustomQuery)(props.componentId, props, _this.props.selectedValue);\n\t\t(0, _helper.updateDefaultQuery)(props.componentId, props, _this.props.selectedValue);\n\n\t\tif (_this.internalComponent && props.defaultQuery) {\n\t\t\t_this.defaultQuery = props.defaultQuery(_this.props.selectedValue, _this.props);\n\n\t\t\tvar _ref = _this.defaultQuery || {},\n\t\t\t    query = _ref.query;\n\n\t\t\tvar defaultQueryOptions = _this.defaultQuery ? (0, _helper.getOptionsFromQuery)(_this.defaultQuery) : null;\n\n\t\t\tif (defaultQueryOptions) {\n\t\t\t\tprops.setQueryOptions(_this.internalComponent, _extends({}, defaultQueryOptions, _this.getAggsQuery()), false);\n\t\t\t} else _this.props.setQueryOptions(_this.internalComponent, _this.getAggsQuery());\n\n\t\t\tvar queryToSet = query || null;\n\t\t\tif (!queryToSet && _this.defaultQuery && _this.defaultQuery.id) {\n\t\t\t\tqueryToSet = _this.defaultQuery;\n\t\t\t}\n\t\t\tprops.updateQuery({\n\t\t\t\tcomponentId: _this.internalComponent,\n\t\t\t\tquery: queryToSet\n\t\t\t});\n\t\t}\n\t\treturn _this;\n\t}\n\n\tReactiveComponent.prototype.componentDidMount = function componentDidMount() {\n\t\tvar _props = this.props,\n\t\t    customQuery = _props.customQuery,\n\t\t    selectedValue = _props.selectedValue,\n\t\t    value = _props.value,\n\t\t    defaultValue = _props.defaultValue,\n\t\t    componentId = _props.componentId,\n\t\t    filterLabel = _props.filterLabel,\n\t\t    showFilter = _props.showFilter,\n\t\t    URLParams = _props.URLParams,\n\t\t    aggregationField = _props.aggregationField,\n\t\t    config = _props.config,\n\t\t    distinctField = _props.distinctField,\n\t\t    distinctFieldConfig = _props.distinctFieldConfig,\n\t\t    index = _props.index;\n\n\t\tvar initialValue = selectedValue || value || defaultValue || null;\n\t\tvar enableAppbase = config.enableAppbase;\n\n\n\t\tif (enableAppbase && aggregationField) {\n\t\t\tconsole.warn('Warning(ReactiveSearch): The `aggregationField` prop has been marked as deprecated, please use the `distinctField` prop instead.');\n\t\t}\n\t\tif (!enableAppbase && (distinctField || distinctFieldConfig)) {\n\t\t\tconsole.warn('Warning(ReactiveSearch): In order to use the `distinctField` and `distinctFieldConfig` props, the `enableAppbase` prop must be set to true in `ReactiveBase`.');\n\t\t}\n\t\tif (!enableAppbase && index) {\n\t\t\tconsole.warn('Warning(ReactiveSearch): In order to use the `index` prop, the `enableAppbase` prop must be set to true in `ReactiveBase`.');\n\t\t}\n\n\t\tif (customQuery) {\n\t\t\tvar calcCustomQuery = customQuery(this.props.selectedValue, this.props);\n\n\t\t\tvar _ref2 = calcCustomQuery || {},\n\t\t\t    query = _ref2.query;\n\n\t\t\tvar customQueryOptions = calcCustomQuery ? (0, _helper.getOptionsFromQuery)(calcCustomQuery) : null;\n\t\t\tif (customQueryOptions) {\n\t\t\t\tthis.props.setQueryOptions(componentId, _extends({}, customQueryOptions, this.getAggsQuery()), false);\n\t\t\t} else this.props.setQueryOptions(componentId, this.getAggsQuery(), false);\n\t\t\tthis.props.updateQuery({\n\t\t\t\tcomponentId: componentId,\n\t\t\t\tquery: query,\n\t\t\t\tvalue: initialValue,\n\t\t\t\tlabel: filterLabel,\n\t\t\t\tshowFilter: showFilter,\n\t\t\t\tURLParams: URLParams\n\t\t\t});\n\t\t}\n\t};\n\n\tReactiveComponent.prototype.componentDidUpdate = function componentDidUpdate(prevProps) {\n\t\tvar _this2 = this;\n\n\t\t// only consider hits and defaultQuery when customQuery is absent\n\t\tif (this.props.onData) {\n\t\t\t(0, _helper.checkSomePropChange)(this.props, prevProps, ['hits', 'aggregations', 'promotedResults', 'total', 'time', 'hidden'], function () {\n\t\t\t\t_this2.props.onData(_this2.getData());\n\t\t\t});\n\t\t}\n\n\t\t(0, _helper.checkPropChange)(this.props.selectedValue, prevProps.selectedValue, function () {\n\t\t\t/*\n   \tReset query when SelectedFilters are clicked. Note: `selectedValue` becomes null.\n   */\n\n\t\t\tif (_this2.props.selectedValue === null) {\n\t\t\t\t_this2.props.updateQuery({\n\t\t\t\t\tcomponentId: _this2.props.componentId,\n\t\t\t\t\tquery: null,\n\t\t\t\t\tURLParams: _this2.props.URLParams\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t\tif (this.props.defaultQuery && !(0, _helper.isEqual)(this.props.defaultQuery(this.props.selectedValue, this.props), this.defaultQuery)) {\n\t\t\tthis.defaultQuery = this.props.defaultQuery(this.props.selectedValue, this.props);\n\n\t\t\tvar _ref3 = this.defaultQuery || {},\n\t\t\t    query = _ref3.query,\n\t\t\t    queryOptions = _objectWithoutProperties(_ref3, ['query']);\n\n\t\t\tif (queryOptions) {\n\t\t\t\tthis.props.setQueryOptions(this.internalComponent, _extends({}, queryOptions, this.getAggsQuery()), false);\n\t\t\t} else this.props.setQueryOptions(this.internalComponent, this.getAggsQuery(), false);\n\t\t\t(0, _helper.updateDefaultQuery)(this.props.componentId, this.props, this.props.selectedValue);\n\t\t\tvar queryToSet = query || null;\n\t\t\tif (!queryToSet && this.defaultQuery && this.defaultQuery.id) {\n\t\t\t\tqueryToSet = this.defaultQuery;\n\t\t\t}\n\t\t\tthis.props.updateQuery({\n\t\t\t\tcomponentId: this.internalComponent,\n\t\t\t\tquery: queryToSet\n\t\t\t});\n\t\t}\n\n\t\tif (this.props.customQuery && !(0, _helper.isEqual)(this.props.customQuery(this.props.selectedValue, this.props), prevProps.customQuery(this.props.selectedValue, this.props))) {\n\t\t\tvar _ref4 = this.props.customQuery(this.props.selectedValue, this.props) || {},\n\t\t\t    _query = _ref4.query,\n\t\t\t    _queryOptions = _objectWithoutProperties(_ref4, ['query']);\n\n\t\t\tif (_queryOptions) {\n\t\t\t\tthis.props.setQueryOptions(this.props.componentId, _extends({}, _queryOptions, this.getAggsQuery()), false);\n\t\t\t} else this.props.setQueryOptions(this.props.componentId, this.getAggsQuery(), false);\n\t\t\t(0, _helper.updateCustomQuery)(this.props.componentId, this.props, this.props.selectedValue);\n\t\t\tvar _queryToSet = _query || null;\n\t\t\tif (!_queryToSet && _queryOptions && _queryOptions.id) {\n\t\t\t\t_queryToSet = _queryOptions;\n\t\t\t}\n\t\t\tthis.props.updateQuery({\n\t\t\t\tcomponentId: this.props.componentId,\n\t\t\t\tquery: _queryToSet,\n\t\t\t\tURLParams: this.props.URLParams\n\t\t\t});\n\t\t}\n\t};\n\n\tReactiveComponent.prototype.getData = function getData() {\n\t\tvar _props2 = this.props,\n\t\t    hits = _props2.hits,\n\t\t    aggregations = _props2.aggregations,\n\t\t    aggregationData = _props2.aggregationData,\n\t\t    promotedResults = _props2.promotedResults,\n\t\t    rawData = _props2.rawData;\n\n\t\tvar filteredResults = (0, _helper.parseHits)(hits);\n\t\tif (promotedResults.length) {\n\t\t\tvar ids = promotedResults.map(function (item) {\n\t\t\t\treturn item._id;\n\t\t\t}).filter(Boolean);\n\t\t\tif (ids) {\n\t\t\t\tfilteredResults = filteredResults.filter(function (item) {\n\t\t\t\t\treturn !ids.includes(item._id);\n\t\t\t\t});\n\t\t\t}\n\t\t\tfilteredResults = [].concat(promotedResults, filteredResults);\n\t\t}\n\t\treturn {\n\t\t\tdata: filteredResults,\n\t\t\tpromotedData: promotedResults,\n\t\t\taggregationData: aggregationData || [],\n\t\t\trawData: rawData,\n\t\t\taggregations: aggregations,\n\t\t\tresultStats: this.stats\n\t\t};\n\t};\n\n\tReactiveComponent.prototype.getComponent = function getComponent() {\n\t\tvar _props3 = this.props,\n\t\t    error = _props3.error,\n\t\t    isLoading = _props3.isLoading,\n\t\t    selectedValue = _props3.selectedValue;\n\n\t\tvar data = _extends({\n\t\t\terror: error,\n\t\t\tloading: isLoading\n\t\t}, this.getData(), {\n\t\t\tvalue: selectedValue,\n\t\t\tsetQuery: this.setQuery\n\t\t});\n\t\treturn (0, _utils.getComponent)(data, this.props);\n\t};\n\n\tReactiveComponent.prototype.render = function render() {\n\t\tif ((0, _utils.hasCustomRenderer)(this.props)) {\n\t\t\treturn this.getComponent();\n\t\t}\n\t\treturn null;\n\t};\n\n\t_createClass(ReactiveComponent, [{\n\t\tkey: 'stats',\n\t\tget: function get() {\n\t\t\treturn (0, _helper.getResultStats)(this.props);\n\t\t}\n\t}]);\n\n\treturn ReactiveComponent;\n}(_react.Component);\n\nReactiveComponent.defaultProps = {\n\tshowFilter: true,\n\tURLParams: false,\n\tsize: 20\n};\n\nReactiveComponent.propTypes = {\n\terror: _types2.default.title,\n\tsetQueryOptions: _types2.default.funcRequired,\n\tupdateQuery: _types2.default.funcRequired,\n\taggregationField: _types2.default.string,\n\taggregationSize: _types2.default.number,\n\tsize: _types2.default.number,\n\taggregations: _types2.default.selectedValues,\n\taggregationData: _types2.default.aggregationData,\n\thits: _types2.default.data,\n\trawData: _types2.default.rawData,\n\tpromotedResults: _types2.default.hits,\n\tisLoading: _types2.default.bool,\n\tselectedValue: _types2.default.selectedValue,\n\tsetCustomQuery: _types2.default.funcRequired,\n\t// component props\n\tchildren: _types2.default.func,\n\tcomponentId: _types2.default.stringRequired,\n\tdefaultQuery: _types2.default.func,\n\tcustomQuery: _types2.default.func,\n\tdefaultValue: _types2.default.any, // eslint-disable-line\n\tvalue: _types2.default.any, // eslint-disable-line\n\tfilterLabel: _types2.default.string,\n\tonQueryChange: _types2.default.func,\n\tonError: _types2.default.func,\n\treact: _types2.default.react,\n\trender: _types2.default.func,\n\tshowFilter: _types2.default.bool,\n\tURLParams: _types2.default.bool,\n\tonData: _types2.default.func,\n\tdistinctField: _types2.default.string,\n\tdistinctFieldConfig: _types2.default.componentObject,\n\tconfig: _types2.default.props,\n\tindex: _types2.default.string\n};\n\n// Add componentType for SSR\nReactiveComponent.componentType = _constants.componentTypes.reactiveComponent;\n\nvar mapStateToProps = function mapStateToProps(state, props) {\n\treturn {\n\t\taggregations: state.aggregations[props.componentId] && state.aggregations[props.componentId] || null,\n\t\taggregationData: state.compositeAggregations[props.componentId] || [],\n\t\thits: state.hits[props.componentId] && state.hits[props.componentId].hits || [],\n\t\trawData: state.rawData[props.componentId],\n\t\tselectedValue: state.selectedValues[props.componentId] && state.selectedValues[props.componentId].value || null,\n\t\tisLoading: state.isLoading[props.componentId],\n\t\terror: state.error[props.componentId],\n\t\tpromotedResults: state.promotedResults[props.componentId] || [],\n\t\ttime: state.hits[props.componentId] && state.hits[props.componentId].time || 0,\n\t\ttotal: state.hits[props.componentId] && state.hits[props.componentId].total,\n\t\thidden: state.hits[props.componentId] && state.hits[props.componentId].hidden,\n\t\tconfig: state.config\n\t};\n};\n\nvar mapDispatchtoProps = function mapDispatchtoProps(dispatch) {\n\treturn {\n\t\tsetCustomQuery: function setCustomQuery(component, query) {\n\t\t\treturn dispatch((0, _actions.setCustomQuery)(component, query));\n\t\t},\n\t\tsetDefaultQuery: function setDefaultQuery(component, query) {\n\t\t\treturn dispatch((0, _actions.setDefaultQuery)(component, query));\n\t\t},\n\t\tsetQueryOptions: function setQueryOptions(component, props, execute) {\n\t\t\treturn dispatch((0, _actions.setQueryOptions)(component, props, execute));\n\t\t},\n\t\tupdateQuery: function updateQuery(updateQueryObject) {\n\t\t\treturn dispatch((0, _actions.updateQuery)(updateQueryObject));\n\t\t}\n\t};\n};\n\nvar ConnectedComponent = (0, _utils.connect)(mapStateToProps, mapDispatchtoProps)(function (props) {\n\treturn _react2.default.createElement(\n\t\t_ComponentWrapper2.default,\n\t\t_extends({}, props, {\n\t\t\tinternalComponent: !!props.defaultQuery,\n\t\t\tcomponentType: _constants.componentTypes.reactiveComponent\n\t\t}),\n\t\tfunction () {\n\t\t\treturn _react2.default.createElement(ReactiveComponent, _extends({ ref: props.myForwardedRef }, props));\n\t\t}\n\t);\n});\n\n// eslint-disable-next-line\nvar ForwardRefComponent = _react2.default.forwardRef(function (props, ref) {\n\treturn _react2.default.createElement(ConnectedComponent, _extends({}, props, { myForwardedRef: ref }));\n});\n\nForwardRefComponent.displayName = 'ReactiveComponent';\nexports.default = ForwardRefComponent;"]},"metadata":{},"sourceType":"script"}